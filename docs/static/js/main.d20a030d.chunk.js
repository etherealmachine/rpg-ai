(this["webpackJsonprpg.ai"]=this["webpackJsonprpg.ai"]||[]).push([[0],Array(74).concat([function(e,t,n){e.exports=n(132)},,,,,function(e,t,n){},,,,,,,,function(e,t){},,,,,,,,,,,,function(e,t,n){var o=n(100);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._1T682EN3wGuui_M4H8-h4d {\n    background: transparent;\n    border: none;\n    outline: none;\n    margin: 4px;\n    padding: 8px 12px;\n    color: white;\n    font-size: 18px;\n    font-weight: 600;\n    box-sizing: border-box;\n    border-radius: 2px;\n    box-shadow: 0 2px 2px 0 rgba(255,255,255,0.14), 0 3px 1px -2px rgba(255,255,255,0.12), 0 1px 5px 0 rgba(255,255,255,0.2);\n  }\n\n  ._1T682EN3wGuui_M4H8-h4d:hover {\n    background: #505050;\n    box-shadow: 0 3px 3px 0 rgba(255,255,255,0.14), 0 1px 7px 0 rgba(255,255,255,0.12), 0 3px 1px -1px rgba(255,255,255,0.2);\n  }\n\n  ._1T682EN3wGuui_M4H8-h4d:active {\n    outline: none;\n    box-shadow: -3px -3px 8px rgba(255, 255, 255, 0.9), 3px 3px 8px rgba(255, 255, 255, 0.9);\n  }\n\n  ._3y7SXyz4JOCnc5uHwMgV6G {\n    background: transparent;\n    border: none;\n    outline: none;\n    margin: 4px;\n    color: white;\n    font-size: 18px;\n    font-weight: 600;\n    box-sizing: border-box;\n    border-radius: 2px;\n    box-shadow: 0 2px 2px 0 rgba(255,255,255,0.14), 0 3px 1px -2px rgba(255,255,255,0.12), 0 1px 5px 0 rgba(255,255,255,0.2);\n  }\n\n  ._3y7SXyz4JOCnc5uHwMgV6G:hover {\n    background: #505050;\n    box-shadow: 0 3px 3px 0 rgba(255,255,255,0.14), 0 1px 7px 0 rgba(255,255,255,0.12), 0 3px 1px -1px rgba(255,255,255,0.2);\n  }\n\n  ._3y7SXyz4JOCnc5uHwMgV6G:active {\n    outline: none;\n    box-shadow: -3px -3px 8px rgba(255, 255, 255, 0.9), 3px 3px 8px rgba(255, 255, 255, 0.9);\n  }\n\n  ._23Y2hTXZx4yRztG6Og2hsX {\n    background: #A20B25;\n  }\n\n  ._23Y2hTXZx4yRztG6Og2hsX:hover {\n    background: #a03e4e;\n  }\n\n  ._3TM3EDP4hscy9_4eMYFQ4j {\n    font-size: 18px;\n    background: transparent;\n    color: white;\n    border: none;\n    border-bottom: 1px solid white;\n    padding: 4px;\n    margin: 4px;\n    margin-bottom: 1px;\n  }\n  \n  ._3TM3EDP4hscy9_4eMYFQ4j:focus {\n    outline: none;\n    border-bottom: 2px solid white;\n    margin-bottom: 0px;\n  }\n\n  ._1QialzHq4mUm3mfxM9dFjo {\n    display: flex;\n    flex-direction: column;\n    background: #000;\n    border-radius: 12px;\n    padding: 8px;\n    box-shadow: 4px 4px 6px rgba(0, 0, 0, 0.2);\n    color: white;\n  }\n  ._1QialzHq4mUm3mfxM9dFjo svg {\n    color: white;\n    font-size: 24px;\n  }\n  ._1QialzHq4mUm3mfxM9dFjo .y38q2UbGKcnf8XF1TwQCQ svg {\n    color: black;\n  }\n  ._1QialzHq4mUm3mfxM9dFjo button {\n    background: black;\n    width: 50px;\n    height: 50px;\n    border: 1px solid white;\n    outline: none;\n    margin: 4px;\n  }\n  ._1QialzHq4mUm3mfxM9dFjo button:hover {\n    background: #505050;\n    box-shadow: -2px -2px 8px rgba(255, 255, 255, 0.9), 2px 2px 8px rgba(255, 255, 255, 0.9);\n  }\n  ._1QialzHq4mUm3mfxM9dFjo button:active {\n    outline: none;\n    border: none;\n    scale: 0.9;\n  }\n  ._1QialzHq4mUm3mfxM9dFjo button.y38q2UbGKcnf8XF1TwQCQ {\n    background: #bbb;\n    box-shadow: -1px -1px 8px rgba(255, 255, 255, 0.5), 1px 1px 8px rgba(255, 255, 255, 0.5);\n  }\n  ._1QialzHq4mUm3mfxM9dFjo button[disabled] {\n    background: #444;\n    box-shadow: none;\n  }\n",""]),t.locals={button:"_1T682EN3wGuui_M4H8-h4d",buttonSmall:"_3y7SXyz4JOCnc5uHwMgV6G",danger:"_23Y2hTXZx4yRztG6Og2hsX",input:"_3TM3EDP4hscy9_4eMYFQ4j",toolbar:"_1QialzHq4mUm3mfxM9dFjo",selected:"y38q2UbGKcnf8XF1TwQCQ"},e.exports=t},,function(e,t,n){var o=n(103);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._1UqzVcjxvXSzZbvZKvXYKi button {\n    background: black;\n    width: 24px;\n    height: 24px;\n    border: 1px solid white;\n    outline: none;\n    margin: 4px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: white;\n  }\n  ._1UqzVcjxvXSzZbvZKvXYKi svg {\n    color: white;\n    font-size: 12px;\n  }\n  ._1UqzVcjxvXSzZbvZKvXYKi button:hover {\n    background: #505050;\n    box-shadow: -2px -2px 8px rgba(255, 255, 255, 0.9), 2px 2px 8px rgba(255, 255, 255, 0.9);\n  }\n  ._1UqzVcjxvXSzZbvZKvXYKi button:active {\n    outline: none;\n    border: none;\n    scale: 0.9;\n  }\n",""]),t.locals={zoom:"_1UqzVcjxvXSzZbvZKvXYKi"},e.exports=t},function(e,t,n){var o=n(105);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._3IlFEbyxwjKJ9Sy-1JAUwL {\n    margin: 0;\n    padding: 0 8px;\n    color: white;\n  }\n  ._3IlFEbyxwjKJ9Sy-1JAUwL h1 {\n    font-size: 24px;\n    font-family: Helvetica serif;\n    padding: 0 8px;\n    margin: 0;\n    color: white;\n  }\n  ._3IlFEbyxwjKJ9Sy-1JAUwL p {\n    font-size: 18px;\n    font-family: Helvetica serif;\n    padding: 0;\n    margin: 0;\n  }\n",""]),t.locals={formattedText:"_3IlFEbyxwjKJ9Sy-1JAUwL"},e.exports=t},function(e,t,n){var o=n(107);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._3W5IvxPia75NSEZmFXoBmA {\n    display: flex;\n    flex-direction: column;\n  }\n  ._3W5IvxPia75NSEZmFXoBmA textarea {\n    height: 400px;\n    outline: none;\n    border: none;\n  }\n  ._3N02lA9zkh_pv4M7FdSKFQ {\n    font-family: Helvetica serif;\n    font-size: 24px;\n    color: white;\n    padding: 8px;\n  }\n  ._1QtaoYNAGXwdUqEuaQejp4 {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin: 12px 24px;\n  }\n",""]),t.locals={editor:"_3W5IvxPia75NSEZmFXoBmA",name:"_3N02lA9zkh_pv4M7FdSKFQ",actions:"_1QtaoYNAGXwdUqEuaQejp4"},e.exports=t},function(e,t,n){var o=n(109);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._3ZJnUkz9JITQGyOviOpcbX {\n    font-family: Helvetica serif;\n    font-size: 18px;\n    color: white;\n    padding: 8px;\n  }\n",""]),t.locals={features:"_3ZJnUkz9JITQGyOviOpcbX"},e.exports=t},,function(e,t,n){var o=n(112);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._7wQ_KhraOD7XNV_7Gcnj4 {\n    width: 0;\n    margin: 8px 0;\n    position: absolute;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    background: #373737;\n    box-sizing: border-box;\n    transition: .2s ease-out;\n  }\n    ._7wQ_KhraOD7XNV_7Gcnj4._1MlyHLj10SQkIHXsiINIx1 {\n      transition: .2s ease-out;\n      z-index: 100;\n    }\n  ._2I5tLfqZmuI4hmhaiAXBzH {\n    position: absolute;\n    top: 0;\n    left: -27px;\n    background: #373737;\n    color: white;\n    outline: none;\n    border: none;\n    font-size: 30px;\n    padding: 8px;\n    border-radius: 4px 0 0 4px;\n  }\n  .NsuFqULDSfAB5HIY7HbUg {\n    height: 97%;\n    overflow: scroll;\n    padding: 8px;\n  }\n",""]),t.locals={drawer:"_7wQ_KhraOD7XNV_7Gcnj4",open:"_1MlyHLj10SQkIHXsiINIx1",toggleButton:"_2I5tLfqZmuI4hmhaiAXBzH",editors:"NsuFqULDSfAB5HIY7HbUg"},e.exports=t},function(e,t,n){var o=n(114);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._2x2e-jPpIYhjiWsM5fkwAx {\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    background: #000;\n    border-radius: 12px;\n    margin-bottom: 50px;\n    margin-left: 24px;\n    padding: 8px;\n    box-shadow: 4px 4px 6px rgba(0, 0, 0, 0.2);\n    color: white;\n  }\n  ._2x2e-jPpIYhjiWsM5fkwAx svg {\n    color: white;\n    font-size: 12px;\n  }\n  ._2x2e-jPpIYhjiWsM5fkwAx button {\n    background: black;\n    width: 24px;\n    height: 24px;\n    border: 1px solid white;\n    outline: none;\n    margin: 4px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: white;\n  }\n  ._2x2e-jPpIYhjiWsM5fkwAx button:hover {\n    background: #505050;\n    box-shadow: -2px -2px 8px rgba(255, 255, 255, 0.9), 2px 2px 8px rgba(255, 255, 255, 0.9);\n  }\n  ._2x2e-jPpIYhjiWsM5fkwAx button:active {\n    outline: none;\n    border: none;\n    scale: 0.9;\n  }\n  ._2x2e-jPpIYhjiWsM5fkwAx button._2oMwTA60o5UHJx7gURY1yl {\n    color: black;\n    background: #bbb;\n    box-shadow: -1px -1px 8px rgba(255, 255, 255, 0.5), 1px 1px 8px rgba(255, 255, 255, 0.5);\n  }\n  ._2x2e-jPpIYhjiWsM5fkwAx h4 {\n    margin: 0;\n    padding: 0;\n  }\n  ._3haVcWyQK8oSqJVT3L0FvF {\n    display: flex;\n  }\n  button.bsoNJThBW3vZOA6dHyCxf {\n    outline: none;\n    border: none;\n  }\n  .bsoNJThBW3vZOA6dHyCxf:hover {\n    cursor: pointer;\n    text-decoration: underline;\n  }\n",""]),t.locals={levels:"_2x2e-jPpIYhjiWsM5fkwAx",selected:"_2oMwTA60o5UHJx7gURY1yl",level:"_3haVcWyQK8oSqJVT3L0FvF",link:"bsoNJThBW3vZOA6dHyCxf"},e.exports=t},function(e,t,n){var o=n(116);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._1429OEOGcRhOAV0J3Gg-KT {\n    position: fixed;\n    z-index: 1000;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n    background-color: rgba(0, 0, 0, 0.4);\n  }\n\n  ._1DN0JTMd6pHMuwsTOAvt2j {\n    position: relative;\n    background-color: #373737;\n    color: #fff;\n    margin: 64px auto;\n    padding: 0 20px 20px 20px;\n    border: 1px solid #888;\n    border-radius: 8px;\n    width: 60%;\n  }\n\n  ._1DN0JTMd6pHMuwsTOAvt2j button {\n    outline: none;\n    border: none;\n    background-color: transparent;\n    color: #fff;\n    font-size: 24px;\n    position: absolute;\n    top: 8px;\n    right: 8px;\n    text-decoration: none;\n    cursor: pointer;\n  }\n",""]),t.locals={modal:"_1429OEOGcRhOAV0J3Gg-KT",modalContent:"_1DN0JTMd6pHMuwsTOAvt2j"},e.exports=t},function(e,t,n){var o=n(118);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._2aM8m-4Xx92dNWnaEGRNME {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    background: #373737;\n    padding: 2px;\n    width: 100%;\n  }\n  ._3HEPmFe0KP_qc9LRO7uwIh {\n    color: white;\n    margin: 8px 24px 8px 24px;\n  }\n  .yr0iF51zaJ_HOYfzQrmAp {\n    margin-left: auto;\n    margin-right: 24px;\n  }\n  label {\n    color: white;\n  }\n  ._2HSpHXCXB2uWq9tBHwycOe:hover {\n    text-decoration: underline;\n    cursor: pointer;\n  }\n",""]),t.locals={menubar:"_2aM8m-4Xx92dNWnaEGRNME",title:"_3HEPmFe0KP_qc9LRO7uwIh",debugMenu:"yr0iF51zaJ_HOYfzQrmAp",mapLink:"_2HSpHXCXB2uWq9tBHwycOe"},e.exports=t},,function(e,t,n){var o=n(121);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  .UROfDRStLvXXdYxVcscBC {\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    padding: 8px;\n    z-index: 1;\n  }\n  .UROfDRStLvXXdYxVcscBC svg {\n    color: #505050;\n    font-size: 24px;\n  }\n  .UROfDRStLvXXdYxVcscBC button {\n    background: transparent;\n    outline: none;\n    border: none; \n    display: flex;\n    margin: 2px;\n    align-items: center;\n    justify-content: center;\n    width: 24px;\n    height: 24px;\n  }\n  .UROfDRStLvXXdYxVcscBC button:hover svg {\n    color: #000;\n  }\n",""]),t.locals={navigation:"UROfDRStLvXXdYxVcscBC"},e.exports=t},function(e,t,n){var o=n(123);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._2LtiBs0QFy0T6xn0SS2W3x {\n    display: flex;\n    flex-direction: column;\n    font-family: Helvetica serif;\n  }\n  ._6Z9YH7Qxp_AWrunyTXjc7 {\n    width: 8in;\n    height: 10.5in;\n    display: flex;\n    flex-direction: column;\n    margin-left: auto;\n    margin-right: auto;\n    border-bottom: 1px solid black;\n    padding: 0.25in;\n  }\n  @media print {\n    ._6Z9YH7Qxp_AWrunyTXjc7 {\n      border-bottom: none !important;\n    }\n  }\n  ._16g_MaPE_LtUpqw4wDWuQu {\n    width: 8in;\n    display: flex;\n    flex-direction: column;\n    margin-left: auto;\n    margin-right: auto;\n    padding: 0.25in;\n  }\n  ._12Z43iiBP-u95gnxi3Kjod {\n    flex-grow: 1;\n  }\n",""]),t.locals={print:"_2LtiBs0QFy0T6xn0SS2W3x",page:"_6Z9YH7Qxp_AWrunyTXjc7",pages:"_16g_MaPE_LtUpqw4wDWuQu",canvasWrapper:"_12Z43iiBP-u95gnxi3Kjod"},e.exports=t},function(e,t,n){var o=n(125);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._32RqLWb9TAlxHXLXW5Y7tH {\n    display: flex;\n    flex-direction: column;\n  }\n  ._32RqLWb9TAlxHXLXW5Y7tH a {\n    color: white;\n  }\n  ._32RqLWb9TAlxHXLXW5Y7tH li {\n    padding: 4px;\n  }\n  ._21_Zg-ByTQDDzrT0uY_Ufj {\n    font-size: 16px;\n    margin-left: auto;\n    margin-right: auto;\n  }\n",""]),t.locals={welcomePage:"_32RqLWb9TAlxHXLXW5Y7tH",footer:"_21_Zg-ByTQDDzrT0uY_Ufj"},e.exports=t},function(e,t,n){var o=n(127);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._28mF98z4gM6RA9OdY-YuEy {\n    color: white;\n    background: black;\n    border-radius: 4px;\n    padding: 8px;\n  }\n",""]),t.locals={tooltip:"_28mF98z4gM6RA9OdY-YuEy"},e.exports=t},function(e,t,n){var o=n(129);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,'\n  ._1v-ohDNr7AFbOSKLT0CYxX {\n    position: relative;\n    display: inline-block;\n    width: 100%;\n    height: 34px;\n  }\n\n  ._1v-ohDNr7AFbOSKLT0CYxX input {\n    opacity: 0;\n    width: 0;\n    height: 0;\n  }\n\n  ._2w1KenDtBt0Wyo3aJE-FRz {\n    position: absolute;\n    cursor: pointer;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: #ccc;\n    -webkit-transition: .4s;\n    transition: .4s;\n    border-radius: 34px;\n  }\n\n  ._2w1KenDtBt0Wyo3aJE-FRz:before {\n    position: absolute;\n    content: "";\n    height: 26px;\n    width: 26px;\n    left: 4px;\n    bottom: 4px;\n    background-color: white;\n    -webkit-transition: .4s;\n    transition: .4s;\n    border-radius: 50%;\n  }\n\n  ._1v-ohDNr7AFbOSKLT0CYxX input:checked + ._2w1KenDtBt0Wyo3aJE-FRz {\n    background-color: #2196F3;\n  }\n\n  ._1v-ohDNr7AFbOSKLT0CYxX input:focus + ._2w1KenDtBt0Wyo3aJE-FRz {\n    box-shadow: 0 0 1px #2196F3;\n  }\n\n  ._1v-ohDNr7AFbOSKLT0CYxX input:checked + ._2w1KenDtBt0Wyo3aJE-FRz:before {\n    -webkit-transform: translateX(26px);\n    -ms-transform: translateX(26px);\n    transform: translateX(26px);\n  }\n',""]),t.locals={toggle:"_1v-ohDNr7AFbOSKLT0CYxX",slider:"_2w1KenDtBt0Wyo3aJE-FRz"},e.exports=t},function(e,t,n){var o=n(131);"string"===typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(17)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){(t=n(16)(!1)).push([e.i,"\n  ._1K0xKFlE3XhuIq8I1FpjrW {\n    width: 100vw;\n    height: 100vh;\n    position: relative;\n    display: flex;\n    flex-direction: column;\n  }\n  ._21qBYvi1wyLFQ2lvKpGD4N {\n    width: 100%;\n    height: 100%;\n    position: relative;\n    display: flex;\n    flex-direction: column;\n  }\n",""]),t.locals={app:"_1K0xKFlE3XhuIq8I1FpjrW",canvasWrapper:"_21qBYvi1wyLFQ2lvKpGD4N"},e.exports=t},function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(31),i=n.n(r),s=n(141),l=n(69),c=(n(79),n(2)),p=n(52),d=n(11),u=n(45),h=n(46),m=n(62),f=n.n(m),v=n(13),y=n(23),g=n(63);function b(e,t){return Math.sqrt(function(e,t){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}(e,t))}function x(e,t,n){return t+(n-t)*e}function w(e,t,n){return[x(e,t[0],n[0]),x(e,t[1],n[1])]}function O(e,t,n){return e<t?t:e>n?n:e}function E(e,t){if(e<0||e>=256)throw new Error("Index out of range");if(t<0||t>=256)throw new Error("Index out of range");return"rgb(".concat(e,", ").concat(t,", 0)")}function j(e){var t=Math.min.apply(Math,Object(y.a)(e.map((function(e){return e[0]})))),n=Math.max.apply(Math,Object(y.a)(e.map((function(e){return e[0]})))),o=Math.min.apply(Math,Object(y.a)(e.map((function(e){return e[1]})))),a=Math.max.apply(Math,Object(y.a)(e.map((function(e){return e[1]}))));return{sw:[t,a],ne:[n,o],w:n-t,h:a-o}}function S(e){var t=0;return e.slice(0,e.length-1).forEach((function(n,o){var a=Object(c.a)(e[o+1],2),r=a[0],i=a[1];t+=n[0]*i-r*n[1]})),t<0}function k(e){return{regions:e.map((function(e){return e.coordinates})),inverted:!1}}function I(e,t,n){var o=[e[0]-t[0],e[1]-t[1]],a=[n[0]-t[0],n[1]-t[1]],r=O((o[0]*a[0]+o[1]*a[1])/(a[0]*a[0]+a[1]*a[1]),0,1),i=[t[0]+a[0]*r,t[1]+a[1]*r];return{point:i,distance:b(i,e)}}function D(e,t){return t.map((function(n,o){return Object(v.a)(Object(v.a)({},I(e,n,t[(o+1)%t.length])),{},{line:[o,(o+1)%t.length]})})).sort((function(e,t){return e.distance-t.distance}))[0]}function T(e,t,n){var o=t.flatMap((function(t,n){return t.geometries.flatMap((function(t,o){return"polygon"===t.type?{feature:n,geometry:o,closestPoint:D(e,t.coordinates)}:"line"===t.type?{feature:n,geometry:o,closestPoint:Object(v.a)(Object(v.a)({},I(e,t.coordinates[0],t.coordinates[1])),{},{line:[0,1]})}:void 0}))})).sort((function(e,t){return void 0===e||void 0===t?1/0:e.closestPoint.distance-t.closestPoint.distance}))[0];if(o)return function(e,t,n){var o=t[e.feature].geometries[e.geometry];if(!["polygon","line"].includes(o.type))return;var a=o.coordinates,r=a[e.closestPoint.line[0]],i=a[e.closestPoint.line[1]];if(n)return Object(v.a)(Object(v.a)({},e),{},{from:Object(y.a)(r),to:Object(y.a)(i)});var s=e.closestPoint.point,l=(i[1]-r[1])/(i[0]-r[0]),c=Math.floor(s[1])-r[1],p=c/l,d=Math.ceil(s[1])-r[1],u=d/l,h=Math.floor(s[0])-r[0],m=h*l,f=Math.ceil(s[0])-r[0],g=f*l,x=[r[0]+p,r[1]+c],w=[r[0]+u,r[1]+d],O=b(x,w),E=[r[0]+h,r[1]+m],j=[r[0]+f,r[1]+g],S=b(E,j);if((isNaN(S)||O<=S)&&O>0)return Object(v.a)(Object(v.a)({},e),{},{from:x,to:w});if((isNaN(O)||S<O)&&S>0)return Object(v.a)(Object(v.a)({},e),{},{from:E,to:j});return}(o,t,n)}function M(e){for(var t=0,n=0,o=0,a=0,r=e.length-1;a<e.length;r=a++){var i=e[a],s=e[r],l=i[0]*s[1]-s[0]*i[1];t+=l,n+=(i[0]+s[0])*l,o+=(i[1]+s[1])*l}var c=3*t;return[n/c,o/c]}var P,_,C,N,F,L,z,W,X,H,A,K,B,R,U,Y,q,G,J,Q,Z,V,$,ee,te,ne,oe,ae,re,ie=n(7),se=n(64),le={name:"Temple of Clanggedin",description:"The Temple to Clanggedin Silverbeard, Father of Battle and the Lord of the Twin Axes, was occupied by a group of Shield Dwarves until recently. The Temple was dug into a nearby cliffside, set up as a forward operating base for dealing with the giants endemic to the mountains.\n\nRecently, the dwarves were ambushed. A clan of goblins allied with the giants to lure the dwarves out and take over the temple. The dwarves were nearly annihilated by the giants, with only a few making it back to town to report.\n\nSince then, the goblins have grown bolder, striking out from their safe base to raid caravans and the occasional farm. The villagers have had enough and convinced the local lord to offer a sizable reward to any adventurers brave enough to root the goblins out of the temple and reclaim it for the civilized world.",levels:[{features:[{geometries:[{type:"polygon",coordinates:[[34,30],[34,27.5],[31.5,27.5],[31.5,29.5],[31,29.5],[31,24],[30,24],[30,29.5],[29.5,29.5],[29.5,27.5],[27,27.5],[27,30],[29.5,30],[30,29.75],[30,30],[31,30],[31,29.75],[31.5,30],[34,30]]},{type:"door",coordinates:[[30,24],[31,24]],subtype:"normal"},{type:"door",coordinates:[[30,30],[31,30]],subtype:"normal"}],properties:{type:"room",name:"Main Entrance",description:"The entrance is flanked by two arrow slits leading to two small guard rooms. \n\nFour **goblins** guard this area, two on either side. They are arguing about dinner and playing dice and have disadvantage on perception checks to stealth past.\n\nIf alerted, they use the secret passages on either side to flee and notify the rest of the group."}},{geometries:[{type:"polygon",coordinates:[[30,27],[30,24],[27,24],[27,27],[28,27],[28,27.5],[29,27.5],[29,27],[30,27]]},{type:"polygon",coordinates:[[34,27],[34,24],[31,24],[31,27],[32,27],[32,27.5],[33,27.5],[33,27],[34,27]]},{type:"door",coordinates:[[28,27.5],[29,27.5]],subtype:"normal"},{type:"door",coordinates:[[32,27.5],[33,27.5]],subtype:"normal"},{type:"door",coordinates:[[31,25],[31,26]],subtype:"normal"},{type:"door",coordinates:[[30,25],[30,26]],subtype:"normal"}],properties:{type:"room",name:"Entry Chambers",description:"These chambers were used to host guests coming to the temple, as well as places for the guards to rest. Now they sit empty."}},{geometries:[{type:"polygon",coordinates:[[34,24.5]]}],properties:{type:"room"}},{geometries:[{type:"polygon",coordinates:[[27,29],[27,28.5],[26.5,28.5],[26.5,25],[27,25],[27,24.5],[26.5,24.5],[26.5,24],[26,24],[26,29],[27,29]]}],properties:{type:"room",name:"Secret Passage",description:"These 2.5ft wide corridors are just big enough for a medium-sized creature to squeeze into. The door from the guard room is visible, but the other entrances are secret doors that require either a **Perception** check (DC 20) or a 10 minute **Investigation** (DC 10) to notice."}},{geometries:[{type:"polygon",coordinates:[[33.5,21.5],[33.5,20.5],[33,20.5],[33,17.5],[33.5,17.5],[33.5,16.5],[33,16.5],[33,14],[31,14],[31,13],[30,13],[30,14],[28,14],[28,16.5],[27.5,16.5],[27.5,17.5],[28,17.5],[28,20.5],[27.5,20.5],[27.5,21.5],[28,21.5],[28,24],[33,24],[33,21.5],[33.5,21.5]]},{type:"decoration",coordinates:[[28,18.5],[29,19.5]],subtype:"statue"},{type:"decoration",coordinates:[[28,15],[29,16]],subtype:"statue"},{type:"decoration",coordinates:[[32,15],[32.5,16]],subtype:"statue"},{type:"decoration",coordinates:[[32,18.5],[32.5,19.5]],subtype:"statue"},{type:"decoration",coordinates:[[28,22],[29,23]],subtype:"statue"},{type:"decoration",coordinates:[[32,22],[33,23]],subtype:"statue"},{type:"door",coordinates:[[30,13],[31,13]],subtype:"normal"}],properties:{type:"room",name:"Main Hall"}},{geometries:[{type:"polygon",coordinates:[[43,24],[43,19.5],[34,19.5],[34,20.5],[33.5,20.5],[33.5,21.5],[34,21.5],[34,24],[43,24]]},{type:"door",coordinates:[[33.5,20.5],[33.5,21.5]],subtype:"normal"}],properties:{type:"room",name:"Armory"}},{geometries:[{type:"polygon",coordinates:[[43,19],[43,14],[34,14],[34,16.5],[33.5,16.5],[33.5,17.5],[34,17.5],[34,19],[38,19],[38,19.5],[39,19.5],[39,19],[43,19]]},{type:"door",coordinates:[[33.5,16.5],[33.5,17.5]],subtype:"normal"},{type:"door",coordinates:[[38,19.5],[39,19.5]],subtype:"normal"}],properties:{type:"room",name:"Barracks"}},{geometries:[{type:"polygon",coordinates:[[27.5,21.5],[27.5,20.5],[27,20.5],[27,19],[22,19],[22,24],[27,24],[27,21.5],[27.5,21.5]]},{type:"door",coordinates:[[27.5,21.5],[27.5,20.5]],subtype:"normal"},{type:"door",coordinates:[[24,19],[25,19]],subtype:"normal"},{type:"door",coordinates:[[22,22],[22,23]],subtype:"normal"}],properties:{type:"room",name:"Kitchen"}},{geometries:[{type:"polygon",coordinates:[[34,24.5]]}],properties:{type:"room"}},{geometries:[{type:"polygon",coordinates:[[27.5,17.5],[27.5,16.5],[27,16.5],[27,14],[19,14],[19,19],[27,19],[27,17.5],[27.5,17.5]]},{type:"door",coordinates:[[27.5,17.5],[27.5,16.5]],subtype:"normal"},{type:"door",coordinates:[[19,19],[20,19]],subtype:"normal"}],properties:{type:"room",name:"Dining Hall"}},{properties:{type:"room",name:"Commode"},geometries:[{type:"polygon",coordinates:[[19,21],[22,21],[22,19],[19,19],[19,21]]}]},{geometries:[{type:"polygon",coordinates:[[19,24],[22,24],[22,21],[19,21],[19,24]]}],properties:{type:"room",name:"Pantry"}},{geometries:[{type:"ellipse",coordinates:[[26,13],[35,4]]},{type:"decoration",coordinates:[[27,8],[28,9]],subtype:"column"},{type:"decoration",coordinates:[[29.5,5],[31.5,7]],subtype:"statue"},{type:"decoration",coordinates:[[33,8],[34,9]],subtype:"column"}],properties:{type:"room",name:"Altar to Clanggedin"}},{properties:{type:"room",name:""},geometries:[{type:"polygon",coordinates:[[35,29],[35,24],[34.5,24],[34.5,24.5],[34,24.5],[34,25],[34.5,25],[34.5,28.5],[34,28.5],[34,29],[35,29]]}]},{geometries:[{type:"line",coordinates:[[34,28.5],[34,29]]}],properties:{type:"other"}},{geometries:[{type:"line",coordinates:[[27,28.5],[27,29]]}],properties:{type:"other"}},{geometries:[{type:"ellipse",coordinates:[[59,14.5],[65.5,11]]},{type:"brush",coordinates:[[60.15345814224975,11.371120556895779],[60.24354823233984,11.281030466805687],[60.36366835245995,11.220970406745629],[60.60390859270019,11.070820256595479],[60.784088772880374,10.980730166505388],[60.964268953060554,10.8906400764153],[61.26456925336085,10.800549986325212],[61.44474943354103,10.77051995629518],[61.68498967378127,10.77051995629518],[62.13544012423172,10.800549986325212],[62.375680364471954,10.800549986325212],[62.615920604712194,10.860610046385268],[62.97628096507255,10.92067010644533],[63.096401085192674,10.950700136475358],[63.15646114525273,10.980730166505388],[63.21652120531279,11.01076019653542],[63.33664132543291,11.100850286625509],[63.51682150561309,11.190940376715597],[63.66697165576324,11.220970406745629],[63.93724192603351,11.281030466805687],[64.05736204615363,11.311060496835719],[64.2375422263338,11.341090526865747],[64.38769237648395,11.371120556895779],[64.5378425266341,11.401150586925807],[64.71802270681428,11.461210646985867],[64.80811279690437,11.491240677015897],[64.92823291702449,11.521270707045925],[65.16847315726473,11.551300737075957],[65.28859327738485,11.611360797136017],[65.31862330741488,11.671420857196075],[65.3486533374449,11.701450887226105],[65.3486533374449,11.731480917256135],[65.40871339750497,11.851601037376254],[65.438743427535,11.971721157496374],[65.49880348759505,12.272021457796674],[65.52883351762509,12.452201637976852],[65.52883351762509,12.54229172806694],[65.52883351762509,12.602351788127],[65.49880348759505,12.662411848187059],[65.438743427535,12.72247190824712],[65.438743427535,12.78253196830718],[65.37868336747493,12.84259202836724],[65.31862330741488,12.902652088427299],[65.25856324735481,13.02277220854742],[65.2285332173248,13.112862298637507],[65.19850318729476,13.232982418757627],[65.16847315726473,13.353102538877748],[65.07838306717464,13.443192628967836],[65.01832300711457,13.533282719057926],[64.98829297708455,13.563312749087954],[64.80811279690437,13.683432869208076],[64.65796264675423,13.803552989328194],[64.65796264675423,13.803552989328194],[64.65796264675423,13.833583019358224],[64.65796264675423,13.833583019358224],[64.65796264675423,13.863613049388254],[64.65796264675423,13.893643079418284],[64.65796264675423,13.953703139478343]]},{type:"brush",coordinates:[[63.276581265372855,14.374123559898761],[63.18649117528276,14.404153589928791],[62.76607075486234,14.464213649988851],[62.52583051462211,14.464213649988851],[62.375680364471954,14.464213649988851],[62.315620304411894,14.464213649988851],[62.2255302143218,14.464213649988851],[62.075380064171654,14.464213649988851],[61.89519988399148,14.494243680018881],[61.53483952363112,14.52427371004891],[61.08438907318067,14.58433377010897],[60.904208893000494,14.614363800139],[60.784088772880374,14.614363800139],[60.724028712820314,14.58433377010897],[60.69399868279028,14.554303740078941],[60.66396865276025,14.52427371004891],[60.63393862273022,14.494243680018881],[60.54384853264013,14.434183619958821],[60.5138185026101,14.404153589928791],[60.45375844255004,14.344093529868731],[60.36366835245995,14.284033469808671],[60.18348817227977,14.193943379718583],[60.06336805215965,14.133883319658521],[59.94324793203953,14.103853289628493],[59.76306775185936,14.013763199538403],[59.64294763173924,13.953703139478343],[59.492797481589086,13.893643079418284],[59.34264733143894,13.833583019358224],[59.28258727137888,13.773522959298164],[59.25255724134885,13.743492929268136],[59.22252721131882,13.713462899238104],[59.22252721131882,13.683432869208076],[59.19249718128879,13.623372809148014],[59.132437121228726,13.533282719057926],[59.10240709119871,13.443192628967836],[59.04234703113864,13.263012448787658],[59.04234703113864,13.172922358697567],[59.07237706116867,13.052802238577447],[59.10240709119871,12.932682118457329],[59.07237706116867,12.84259202836724],[59.07237706116867,12.78253196830718],[59.10240709119871,12.69244187821709],[59.132437121228726,12.602351788127],[59.16246715125876,12.452201637976852],[59.19249718128879,12.42217160794682],[59.22252721131882,12.392141577916792],[59.22252721131882,12.392141577916792]]},{type:"decoration",coordinates:[[61,11.5],[63.5,12]],subtype:"column"}],properties:{type:"room",name:"Cavernous Pit",description:"The center of this cavern has large pit that descends into the darkness."}},{geometries:[{type:"brush",coordinates:[[59.91038468782345,11.992837343841897],[59.702051354490116,11.873789724794278],[59.31514659258536,11.75474210574666],[58.74967040210917,11.635694486699041],[58.27347992591869,11.516646867651422],[57.85681325925203,11.457123058127614],[57.559194211632985,11.42736115336571],[57.26157516401394,11.42736115336571],[56.93419421163299,11.42736115336571],[56.725860878299656,11.457123058127614],[56.398479925918714,11.486884962889519],[55.95205135449014,11.576170677175233],[55.267527544966335,11.75474210574666],[54.55324183068062,11.992837343841897],[53.422289449728254,12.260694486699037],[52.916337068775874,12.320218296222846],[52.38062278306159,12.320218296222846],[51.99371802115683,12.320218296222846],[51.517527544966356,12.29045639146094],[50.80324183068065,12.29045639146094],[50.14847992591875,12.29045639146094],[48.987765640204465,12.201170677175229],[48.51157516401399,12.141646867651419],[48.035384687823516,12.08212305812761],[47.648479925918764,12.052361153365705],[47.2913370687759,12.052361153365705],[46.54728944972829,12.0225992486038],[46.07109897353782,12.0225992486038],[45.59490849734735,11.992837343841897],[45.297289449728304,11.963075439079992],[44.731813259252114,11.903551629556182],[44.37467040210926,11.844027820032373],[44.166337068775924,11.81426591527047],[43.86871802115688,11.784504010508563],[43.511575164014026,11.784504010508563],[43.3032418306807,11.784504010508563],[43.18419421163308,11.784504010508563],[43.09490849734736,11.784504010508563],[42.97586087829974,11.784504010508563],[42.82705135449022,11.784504010508563],[42.58895611639499,11.81426591527047],[42.41038468782356,11.844027820032373],[42.23181325925213,11.873789724794278],[42.20205135449022,11.903551629556182],[42.17228944972832,11.903551629556182],[42.112765640204515,11.933313534318087],[42.02347992591879,11.992837343841897],[41.934194211633084,12.052361153365705],[41.815146592585464,12.111884962889516],[41.63657516401404,12.171408772413322],[41.54728944972832,12.230932581937132],[41.487765640204515,12.260694486699037],[41.428241830680705,12.320218296222846],[41.3687180211569,12.379742105746656],[41.30919421163309,12.439265915270465],[41.27943230687118,12.498789724794275],[41.24967040210928,12.558313534318083],[41.21990849734737,12.588075439079988],[41.19014659258547,12.677361153365702],[41.160384687823566,12.73688496288951],[41.160384687823566,12.766646867651415],[41.160384687823566,12.826170677175224],[41.13062278306166,12.855932581937129],[41.13062278306166,12.915456391460937],[41.100860878299756,12.974980200984747],[41.100860878299756,13.034504010508556],[41.100860878299756,13.034504010508556],[41.100860878299756,13.034504010508556],[41.100860878299756,13.064265915270461],[41.100860878299756,13.064265915270461],[41.100860878299756,13.064265915270461]]}],properties:{type:"room",name:"Backdoor",description:"The secret door here is clearly visible from the cavern side, where rough rock walls turn into a smooth stone door. From the other side it requires a **Perception** check (DC 20) or a 30 minute **Investigation** check (DC 15). The goblins have yet to notice this chink in their armor."}},{geometries:[{type:"brush",coordinates:[[67.97586087829959,29.96902782003226],[67.97586087829959,29.730932581937022],[67.97586087829959,29.25474210574655],[67.97586087829959,28.65950401050846],[67.94609897353769,28.153551629556084],[67.73776564020436,27.558313534317985],[67.58895611639483,27.290456391460847],[67.44014659258531,26.992837343841803],[67.26157516401388,26.605932581937047],[67.05324183068055,26.040456391460854],[66.39847992591864,24.820218296222766],[65.98181325925198,23.957123058127536],[65.77347992591865,23.332123058127543],[65.65443230687103,22.82617067717516],[65.65443230687103,22.260694486698974],[65.65443230687103,21.724980200984692],[65.59490849734722,21.338075439079937],[65.50562278306151,20.951170677175174],[65.35681325925198,20.415456391460893],[64.94014659258532,19.463075439079944],[64.731813259252,18.957123058127568],[64.55324183068056,18.510694486698995],[64.43419421163294,18.034504010508524],[64.19609897353772,17.14164686765139],[64.19609897353772,16.63569448669901],[64.28538468782342,16.278551629556155],[64.31514659258532,16.099980200984728],[64.28538468782342,16.070218296222823],[64.25562278306151,15.98093258193711],[64.1663370687758,15.832123058127587],[64.106813259252,15.504742105746637],[64.13657516401389,15.296408772413304],[64.19609897353772,15.088075439079972],[64.19609897353772,14.998789724794257],[64.19609897353772,14.969027820032354],[64.19609897353772,14.969027820032354],[64.22586087829961,14.87974210574664],[64.22586087829961,14.760694486699022],[64.1663370687758,14.641646867651405],[64.106813259252,14.463075439079976],[64.07705135449008,14.373789724794262],[64.07705135449008,14.373789724794262],[64.07705135449008,14.344027820032357],[64.07705135449008,14.344027820032357],[64.04728944972818,14.284504010508549],[63.958003735442475,14.224980200984739],[63.86871802115675,14.16545639146093],[63.80919421163295,14.135694486699027],[63.80919421163295,14.135694486699027]]}],properties:{type:"room",name:"Side Entrance",description:"Hidden behind some bushes to the East is the secret side entrance. Finding this entrance is either a **Perception** check (DC "}},{geometries:[{type:"brush",coordinates:[[66.51982450861607,25.455204640979773],[66.48979447858603,25.425174610949746],[66.36967435846593,25.365114550889682],[66.0393440281356,25.305054490829622],[65.70901369780526,25.275024460799592],[65.46877345756504,25.275024460799592],[65.19850318729476,25.305054490829622],[65.07838306717464,25.305054490829622],[64.8381428269344,25.425174610949746],[64.11742210621368,25.635384821159953],[63.69700168579326,25.7855349713101],[63.24655123534282,25.905655091430223],[62.28559027438187,26.05580524158037],[61.95525994405154,26.085835271610396],[61.65495964375123,26.11586530164043],[61.47477946357106,26.11586530164043],[61.20450919330079,26.085835271610396],[60.84414883294043,26.02577521155034],[60.57387856267017,25.96571515149028],[60.33363832242993,25.87562506140019],[60.09339808218969,25.815565001340133],[59.79309778188939,25.69544488122001],[59.67297766176927,25.635384821159953],[59.552857541649146,25.575324761099896],[59.43273742152903,25.485234671009803],[59.28258727137888,25.425174610949746],[59.04234703113864,25.365114550889682],[58.89219688098849,25.365114550889682],[58.65195664074825,25.335084520859656],[58.41171640050801,25.305054490829622],[58.17147616026777,25.154904340679476],[57.93123592002754,24.914664100439236],[57.420725409517026,24.644393830168966],[57.27057525936688,24.524273710048853],[57.150455139246766,24.34409352986867],[57.03033501912664,24.16391334968849],[56.94024492903655,23.923673109448252],[56.82012480891644,23.653402839177982],[56.51982450861613,23.14289232866747],[56.309614298405926,22.81256199833714],[55.9792839680756,22.392141577916732],[55.28859327738491,21.79154097731613],[54.718022706814345,21.43118061695577],[53.87718186597351,21.01076019653536],[53.60691159570324,20.890640076415238],[53.51682150561315,20.800549986325148],[53.51682150561315,20.710459896235058],[53.48679147558312,20.650399836174998],[53.366671355463005,20.50024968602485],[53.33664132543297,20.109859295634465],[53.33664132543297,19.359108544883718],[53.24655123534288,18.728477914253087],[53.21652120531285,18.54829773407291],[53.21652120531285,18.54829773407291]]},{type:"brush",coordinates:[[56.91021489900652,24.13388331965846],[56.70000468879631,24.16391334968849],[56.51982450861613,24.13388331965846],[56.21952420831584,24.13388331965846],[55.79910378789542,24.16391334968849],[55.64895363774527,24.193943379718522],[55.46877345756509,24.284033469808605],[55.28859327738491,24.374123559898695],[54.898202886994525,24.58433377010891],[54.62793261672425,24.76451395028909],[54.297602286393925,24.974724160499296],[53.72703171582336,25.365114550889682],[53.366671355463005,25.575324761099896],[52.79610078489244,25.905655091430223],[52.465770454562104,26.11586530164043],[51.9552599440516,26.47622566200079],[51.684989673781324,26.626375812150936],[51.294599283390944,26.836586022361143],[51.02432901312067,26.956706142481266],[50.54384853264019,27.106856292631413],[50.27357826236993,27.166916352691473],[49.943247932039604,27.196946382721503],[49.67297766176933,27.196946382721503],[49.49279748158915,27.196946382721503],[49.462767451559124,27.166916352691473],[49.462767451559124,27.106856292631413],[49.462767451559124,27.106856292631413]]},{type:"brush",coordinates:[[55.6301848689765,21.69169112746629],[55.769073757865385,21.52502446079962],[56.13018486897649,21.080580016355178],[56.4912959800876,20.663913349688514],[56.68574042453205,20.413913349688514],[57.074629313420935,19.775024460799628],[57.18574042453204,19.386135571910746],[57.26907375786538,19.10835779413297],[57.324629313420935,18.830580016355192],[57.324629313420935,18.60835779413297],[57.352407091198714,18.302802238577417],[57.40796264675427,17.99724668302186],[57.54685153564315,17.608357794132978],[57.71351820230982,17.247246683021867],[57.852407091198714,16.88613557191076],[58.130184868976485,16.469468905244092],[58.32462931342093,16.330580016355206],[58.46351820230982,16.27502446079965],[58.51907375786537,16.27502446079965],[58.57462931342093,16.27502446079965],[58.60240709119871,16.27502446079965],[58.60240709119871,16.27502446079965],[58.60240709119871,16.27502446079965]]}],properties:{type:"room",description:"A colony of **vampire bats** lives here. The bats sleep during the day and go out at night to hunt. Sneaking past the bats is possible (**Stealth** DC 10), but if awoken they attack.",name:"Bat Country"}},{geometries:[{type:"polygon",coordinates:[[41,14],[41.5,14],[41.5,13],[41,13],[41,14]]}],properties:{type:"room"}},{geometries:[{type:"line",coordinates:[[41,14],[41.5,14]]},{type:"door",coordinates:[[41,14],[41.5,14]],subtype:"secret"}],properties:{type:"other"}},{geometries:[{type:"line",coordinates:[[34.5,24],[35,24]]},{type:"door",coordinates:[[34.5,24],[35,24]],subtype:"secret"}],properties:{type:"other"}},{geometries:[{type:"line",coordinates:[[34,24.5],[34,25]]},{type:"door",coordinates:[[34,24.5],[34,25]],subtype:"secret"}],properties:{type:"other"}},{geometries:[{type:"line",coordinates:[[27,24.5],[27,25]]},{type:"door",coordinates:[[27,24.5],[27,25]],subtype:"secret"}],properties:{type:"other"}},{geometries:[{type:"line",coordinates:[[26,24],[26.5,24]]},{type:"door",coordinates:[[26,24],[26.5,24]],subtype:"secret"}],properties:{type:"other"}},{geometries:[{type:"line",coordinates:[[30,5],[31,5]]},{type:"door",coordinates:[[30,5],[31,5]],subtype:"secret"}],properties:{type:"other"}},{geometries:[{type:"line",coordinates:[[67.5,30.5],[68.5,30.5]]},{type:"door",coordinates:[[67.5,30.5],[68.5,30.5]],subtype:"secret"}],properties:{type:"other"}}],name:"Main Level",description:""}]},ce=[],pe=[];function de(e){return function(t,n,o){var a=o.value;o.value=function(){var t=Array.from(arguments);this.setState(Object(se.a)(this,(function(n){var o=JSON.stringify(n.maps[n.selection.mapIndex]);a.bind(n).apply(void 0,Object(y.a)(t));var r=JSON.stringify(n.maps[n.selection.mapIndex]);e&&e.undoable&&(0===ce.length||ce[ce.length-1]!==o)&&r!==o&&(ce.push(o),ce.length>100&&ce.splice(0,ce.length-100)),n.hasOwnProperty("notifyChange")&&n.notifyChange()})))}}}var ue=(P=de(),_=de(),C=de(),N=de(),F=de(),L=de({undoable:!0}),z=de(),W=de({undoable:!0}),X=de(),H=de(),A=de({undoable:!0}),K=de({undoable:!0}),B=de({undoable:!0}),R=de({undoable:!0}),U=de({undoable:!0}),Y=de({undoable:!0}),q=de(),G=de(),J=de(),Q=de(),Z=de(),V=de(),$=de(),ee=de(),te=de(),ne=de(),oe=de(),ae=de(),re=function(){function e(){Object(u.a)(this,e),this.tools={pointer:{selected:!0,group:0,polygon:!0,disabled:!1},walls:{selected:!1,group:1,polygon:!0,disabled:!1},stairs:{selected:!1,group:1,polygon:!1,disabled:!1},doors:{selected:!1,group:1,polygon:!1,disabled:!1,subtype:"normal"},decoration:{selected:!1,group:1,polygon:!1,disabled:!1,subtype:"statue"},brush:{selected:!1,group:2,polygon:!0,disabled:!1},rect:{selected:!1,group:2,polygon:!0,disabled:!1},polygon:{selected:!1,group:2,polygon:!0,disabled:!1},ellipse:{selected:!1,group:2,polygon:!0,disabled:!1}},this.scale=1,this.offset=[0,0],this.maps=[le],this.drawerOpen=!1,this.drawerWidth=400,this.selection={mapIndex:0,levelIndex:0,featureIndex:void 0,geometryIndex:void 0},this.gridSteps=1,this.debug=!1,this.showWelcome=!0,this.setState=function(e){},this.notifyChange=function(){}}return Object(h.a)(e,[{key:"getSelectedFeature",value:function(){if(void 0!==this.selection.featureIndex&&void 0!==this.selection.geometryIndex){var e=this.maps[this.selection.mapIndex].levels[this.selection.levelIndex].features[this.selection.featureIndex];return{feature:e,geometry:e.geometries[this.selection.geometryIndex]}}}},{key:"save",value:function(e){this.maps[this.selection.mapIndex].name=e,(""!==this.maps[this.maps.length-1].name||this.maps[this.maps.length-1].levels[0].features.length>0)&&this.maps.push({name:"",description:"",levels:[{features:[]}]})}},{key:"undo",value:function(){if(0!==ce.length){var e=ce.pop();e&&(pe.push(JSON.parse(JSON.stringify(this.maps[this.selection.mapIndex]))),pe.length>10&&pe.splice(0,ce.length-10),this.maps[this.selection.mapIndex]=JSON.parse(e))}}},{key:"redo",value:function(){if(0!==pe.length){var e=pe.pop();ce.push(JSON.parse(JSON.stringify(this.maps[this.selection.mapIndex]))),ce.length>10&&ce.splice(0,ce.length-10),e&&(this.maps[this.selection.mapIndex]=JSON.parse(e))}}},{key:"toggleWelcome",value:function(){this.showWelcome=!this.showWelcome}},{key:"newMap",value:function(){ce=[],pe=[],(""!==this.maps[this.maps.length-1].name||this.maps[this.maps.length-1].levels[0].features.length>0)&&this.maps.push({name:"",description:"",levels:[{features:[]}]}),this.selection={mapIndex:this.maps.length-1,levelIndex:0,featureIndex:void 0,geometryIndex:void 0},this.scale=1,this.offset=[0,0]}},{key:"addLevel",value:function(){this.maps[this.selection.mapIndex].levels.push({features:[]}),this.selection.levelIndex=this.maps[this.selection.mapIndex].levels.length-1,this.selection.featureIndex=void 0,this.selection.geometryIndex=void 0}},{key:"selectLevel",value:function(e){this.selection.levelIndex=e,this.selection.featureIndex=void 0,this.selection.geometryIndex=void 0}},{key:"removeLevel",value:function(e){var t=this.maps[this.selection.mapIndex].levels;t.length<=1||(t.splice(e,1),this.selection.levelIndex===t.length&&this.selection.levelIndex--,this.selection.featureIndex=void 0,this.selection.geometryIndex=void 0)}},{key:"setDebug",value:function(e){this.debug=e}},{key:"setGridSteps",value:function(e){this.gridSteps=e}},{key:"handleDrag",value:function(e,t){if(e[0]!==t[0]||e[1]!==t[1]){var n=this.maps[this.selection.mapIndex].levels[this.selection.levelIndex].features;if(this.tools.stairs.selected)n.push({properties:{type:"other"},geometries:[{type:"stairs",coordinates:[e,t]}]});else if(this.tools.decoration.selected)n.push({properties:{type:"other"},geometries:[{type:"decoration",coordinates:[e,t],subtype:this.tools.decoration.subtype}]});else if(this.tools.rect.selected)n.push({geometries:[{type:"polygon",coordinates:[[e[0],e[1]],[t[0],e[1]],[t[0],t[1]],[e[0],t[1]],[e[0],e[1]]]}],properties:{type:"room"}});else if(this.tools.ellipse.selected)n.push({geometries:[{type:"ellipse",coordinates:[e,t]}],properties:{type:"room"}});else if(this.tools.walls.selected)n.push({geometries:[{type:"line",coordinates:[e,t]}],properties:{type:"other"}});else if(void 0!==this.selection.featureIndex){var o=n[this.selection.featureIndex];if(void 0!==o){var a=[t[0]-e[0],t[1]-e[1]];return void o.geometries.forEach((function(e){e.coordinates.forEach((function(e){e[0]+=a[0],e[1]+=a[1]}))}))}}}}},{key:"handlePolygon",value:function(e){var t=this.maps[this.selection.mapIndex].levels[this.selection.levelIndex].features;S(e)||e.reverse(),t.push({geometries:[{type:"polygon",coordinates:e}],properties:{type:this.tools.walls.selected?"room":"other"}})}},{key:"handleBrush",value:function(e){var t=this.maps[this.selection.mapIndex].levels[this.selection.levelIndex].features;this.tools.walls.selected&&this.tools.brush.selected&&t.push({geometries:[{type:"brush",coordinates:e}],properties:{type:"room"}})}},{key:"handleDelete",value:function(){var e=this.maps[this.selection.mapIndex].levels[this.selection.levelIndex].features;if(void 0!==this.selection.featureIndex&&void 0!==this.selection.geometryIndex){var t=e[this.selection.featureIndex];0===this.selection.geometryIndex||1===t.geometries.length?e.splice(this.selection.featureIndex,1):t.geometries.splice(this.selection.geometryIndex,1),this.selection.featureIndex=void 0,this.selection.geometryIndex=void 0}}},{key:"addDoor",value:function(e){this.maps[this.selection.mapIndex].levels[this.selection.levelIndex].features[e.feature].geometries.push({type:"door",coordinates:[e.from,e.to],subtype:this.tools.doors.subtype})}},{key:"handleGroup",value:function(e,t){var n=this.maps[this.selection.mapIndex].levels[this.selection.levelIndex].features;if(void 0!==this.selection.featureIndex&&void 0!==this.selection.geometryIndex){var o=n[this.selection.featureIndex];if(this.selection.featureIndex===e){if(1===o.geometries.length)return;var a=o.geometries[t];o.geometries.splice(t,1),n.push({properties:{type:["polygon","ellipse"].includes(a.type)?"room":"other"},geometries:[a]})}else{var r=o.geometries.find((function(e){return"polygon"===e.type})),i=n[e].geometries[t];if(r&&"polygon"===i.type){var s=function(e,t){var n=g.union(k(e),k([t])).regions.map((function(e){return{type:"polygon",coordinates:e}}));return n.sort((function(e,t){return"polygon"===e.type&&"polygon"!==t.type?-1:"polygon"===t.type&&"polygon"!==e.type?1:"polygon"!==e.type&&"polygon"!==t.type||S(e.coordinates)&&S(t.coordinates)?0:S(e.coordinates)&&!S(t.coordinates)?-1:1})),n.forEach((function(e){"polygon"===e.type&&e.coordinates[0]!==e.coordinates[e.coordinates.length-1]&&e.coordinates.push([e.coordinates[0][0],e.coordinates[0][1]])})),n}(o.geometries.filter((function(e){return"polygon"===e.type})),i),l=o.geometries.filter((function(e){return"polygon"!==e.type}));o.geometries=l.concat(s)}else o.geometries=o.geometries.concat(n[e].geometries);n.splice(e,1),this.selection.featureIndex>e&&this.selection.featureIndex--}}}},{key:"setSelectedTool",value:function(e){var t=this.tools[e];if(t.selected)t.selected=!1;else{if(0===t.group)return Object.values(this.tools).forEach((function(e){e.selected=!1})),void(t.selected=!0);Object.values(this.tools).forEach((function(e){0===e.group&&(e.selected=!1)})),Object.values(this.tools).forEach((function(e){e.group===t.group&&(e.selected=!1)})),t.polygon?Object.values(this.tools).forEach((function(e){2===e.group&&(e.disabled=!1)})):Object.values(this.tools).forEach((function(e){2===e.group&&(e.selected=!1,e.disabled=!0)})),t.selected=!0}}},{key:"setToolOption",value:function(e,t){this.tools[e].subtype=t}},{key:"setSelection",value:function(e){e.mapIndex!==this.selection.mapIndex&&(ce=[],pe=[]),this.selection=e}},{key:"setOffset",value:function(e){this.offset=e}},{key:"setZoom",value:function(e,t){this.scale=e,this.offset=t}},{key:"setDrawerOpen",value:function(e){this.drawerOpen=e}},{key:"setDrawerWidth",value:function(e){this.drawerWidth=e}},{key:"setMapDescription",value:function(e){this.maps[this.selection.mapIndex].name=e.name,this.maps[this.selection.mapIndex].description=e.description}},{key:"setLevelDescription",value:function(e){var t=this.maps[this.selection.mapIndex].levels[this.selection.levelIndex];t.name=e.name,t.description=e.description}},{key:"setFeatureDescription",value:function(e){if(void 0!==this.selection.featureIndex){var t=this.maps[this.selection.mapIndex].levels[this.selection.levelIndex].features[this.selection.featureIndex];Object.assign(t.properties,e)}}},{key:"setFeatureOrder",value:function(e,t){var n=this.maps[this.selection.mapIndex].levels[this.selection.levelIndex],o=n.features.splice(e,1),a=Object(c.a)(o,1)[0];n.features.splice(t,0,a)}},{key:"reset",value:function(){Object.assign(this,new e)}}]),e}(),Object(ie.a)(re.prototype,"save",[P],Object.getOwnPropertyDescriptor(re.prototype,"save"),re.prototype),Object(ie.a)(re.prototype,"undo",[_],Object.getOwnPropertyDescriptor(re.prototype,"undo"),re.prototype),Object(ie.a)(re.prototype,"redo",[C],Object.getOwnPropertyDescriptor(re.prototype,"redo"),re.prototype),Object(ie.a)(re.prototype,"toggleWelcome",[N],Object.getOwnPropertyDescriptor(re.prototype,"toggleWelcome"),re.prototype),Object(ie.a)(re.prototype,"newMap",[F],Object.getOwnPropertyDescriptor(re.prototype,"newMap"),re.prototype),Object(ie.a)(re.prototype,"addLevel",[L],Object.getOwnPropertyDescriptor(re.prototype,"addLevel"),re.prototype),Object(ie.a)(re.prototype,"selectLevel",[z],Object.getOwnPropertyDescriptor(re.prototype,"selectLevel"),re.prototype),Object(ie.a)(re.prototype,"removeLevel",[W],Object.getOwnPropertyDescriptor(re.prototype,"removeLevel"),re.prototype),Object(ie.a)(re.prototype,"setDebug",[X],Object.getOwnPropertyDescriptor(re.prototype,"setDebug"),re.prototype),Object(ie.a)(re.prototype,"setGridSteps",[H],Object.getOwnPropertyDescriptor(re.prototype,"setGridSteps"),re.prototype),Object(ie.a)(re.prototype,"handleDrag",[A],Object.getOwnPropertyDescriptor(re.prototype,"handleDrag"),re.prototype),Object(ie.a)(re.prototype,"handlePolygon",[K],Object.getOwnPropertyDescriptor(re.prototype,"handlePolygon"),re.prototype),Object(ie.a)(re.prototype,"handleBrush",[B],Object.getOwnPropertyDescriptor(re.prototype,"handleBrush"),re.prototype),Object(ie.a)(re.prototype,"handleDelete",[R],Object.getOwnPropertyDescriptor(re.prototype,"handleDelete"),re.prototype),Object(ie.a)(re.prototype,"addDoor",[U],Object.getOwnPropertyDescriptor(re.prototype,"addDoor"),re.prototype),Object(ie.a)(re.prototype,"handleGroup",[Y],Object.getOwnPropertyDescriptor(re.prototype,"handleGroup"),re.prototype),Object(ie.a)(re.prototype,"setSelectedTool",[q],Object.getOwnPropertyDescriptor(re.prototype,"setSelectedTool"),re.prototype),Object(ie.a)(re.prototype,"setToolOption",[G],Object.getOwnPropertyDescriptor(re.prototype,"setToolOption"),re.prototype),Object(ie.a)(re.prototype,"setSelection",[J],Object.getOwnPropertyDescriptor(re.prototype,"setSelection"),re.prototype),Object(ie.a)(re.prototype,"setOffset",[Q],Object.getOwnPropertyDescriptor(re.prototype,"setOffset"),re.prototype),Object(ie.a)(re.prototype,"setZoom",[Z],Object.getOwnPropertyDescriptor(re.prototype,"setZoom"),re.prototype),Object(ie.a)(re.prototype,"setDrawerOpen",[V],Object.getOwnPropertyDescriptor(re.prototype,"setDrawerOpen"),re.prototype),Object(ie.a)(re.prototype,"setDrawerWidth",[$],Object.getOwnPropertyDescriptor(re.prototype,"setDrawerWidth"),re.prototype),Object(ie.a)(re.prototype,"setMapDescription",[ee],Object.getOwnPropertyDescriptor(re.prototype,"setMapDescription"),re.prototype),Object(ie.a)(re.prototype,"setLevelDescription",[te],Object.getOwnPropertyDescriptor(re.prototype,"setLevelDescription"),re.prototype),Object(ie.a)(re.prototype,"setFeatureDescription",[ne],Object.getOwnPropertyDescriptor(re.prototype,"setFeatureDescription"),re.prototype),Object(ie.a)(re.prototype,"setFeatureOrder",[oe],Object.getOwnPropertyDescriptor(re.prototype,"setFeatureOrder"),re.prototype),Object(ie.a)(re.prototype,"reset",[ae],Object.getOwnPropertyDescriptor(re.prototype,"reset"),re.prototype),re),he=a.a.createContext(new ue),me=n(10),fe=n(21),ve=n.n(fe),ye=n(6),ge=n(99),be=n(102);function xe(e){var t=Object(o.useContext)(he),n=function(n){return function(){var o=e.renderer;if(o){var a=t.scale,r=t.offset,i=O(a*n,.2,4),s=[o.canvas.width/2,o.canvas.height/2],l=o.canvasToWorld(s),c=[s[0]/i-r[0],s[1]/i-r[1]],p=[r[0]-(l[0]-c[0]),r[1]-(l[1]-c[1])];window.requestAnimationFrame((function(){t.setZoom(i,p)}))}}};return a.a.createElement("div",{className:ve()(ge.toolbar,be.zoom),style:{position:"absolute",top:"50px",right:"50px"}},a.a.createElement("button",{onClick:n(1.1)},a.a.createElement(me.a,{icon:ye.j})),a.a.createElement("button",{onClick:n(.9)},a.a.createElement(me.a,{icon:ye.h})))}var we=["#2f557466","#2f5574","#2f557466","#2f5574","#668dad66","#668dad"],Oe=function(){function e(t,n){var o=this;Object(u.a)(this,e),this.mouse=void 0,this.mouseDown=!1,this.drag=void 0,this.specialKeys={shift:!1,alt:!1,ctrl:!1,space:!1},this.points=[],this.polygonToolSelected=!1,this.hover=void 0,this.size=30,this.fps=0,this.requestID=void 0,this.appState=new ue,this.canvas=void 0,this.ctx=void 0,this.bufferCanvas=void 0,this.bufferCtx=void 0,this.dirty=new Date,this.mode=void 0,this.onMouseDown=function(e){o.dirty=new Date,o.mouseDown=!0;var t=o.mouse;if(!(e instanceof MouseEvent&&2===e.button))if(t&&(o.drag={start:o.canvasToTile(t),end:o.canvasToTile(t)}),o.appState.tools.pointer.selected){var n,a,r,i,s=o.appState.selection.featureIndex,l=null===(n=o.hover)||void 0===n?void 0:n.featureIndex,c=null===(a=o.hover)||void 0===a?void 0:a.geometryIndex;if(e.shiftKey&&void 0!==s&&void 0!==l&&void 0!==c)o.appState.handleGroup(l,c);else o.appState.setSelection({mapIndex:o.appState.selection.mapIndex,levelIndex:o.appState.selection.levelIndex,featureIndex:null===(r=o.hover)||void 0===r?void 0:r.featureIndex,geometryIndex:null===(i=o.hover)||void 0===i?void 0:i.geometryIndex})}else if(o.appState.tools.doors.selected&&t){var p=T(o.worldToTile(o.canvasToWorld(t),!1),o.appState.maps[o.appState.selection.mapIndex].levels[o.appState.selection.levelIndex].features,e.shiftKey);p&&o.appState.addDoor(p)}},this.onMouseUp=function(){if(o.dirty=new Date,o.mouseDown=!1,o.mouse&&o.appState.tools.polygon.selected){var e=o.canvasToTile(o.mouse);o.points.length>=1&&b(o.points[0],e)<1?(o.appState.handlePolygon(o.points),o.points=[]):o.points.push(e)}else if(o.appState.tools.brush.selected)o.appState.handleBrush(o.points),o.points=[],o.drag=void 0;else if(o.drag){var t=[o.drag.start,o.drag.end],n=t[0],a=t[1];if(o.appState.tools.rect.selected||o.appState.tools.ellipse.selected){var r=j([n,a]);n=r.sw,a=r.ne}o.appState.handleDrag(n,a),o.drag=void 0,o.points=[]}},this.onMouseMove=function(e){if(o.dirty=new Date,"touches"in e&&e.target){var t=e.target.getBoundingClientRect();o.mouse=[e.touches[0].clientX-t.left,e.touches[0].clientY-t.top]}else"offsetX"in e&&(o.mouse=[e.offsetX,e.offsetY]);if(o.mouse&&o.mouseDown&&o.drag)if(o.specialKeys.space||e instanceof MouseEvent&&1===e.buttons){var n=o.canvasToWorld(o.mouse),a=[o.drag.start[0]*o.size-n[0],o.drag.start[1]*o.size-n[1]],r=o.appState.offset;r[0]-=a[0],r[1]-=a[1],o.drag.start=o.canvasToTile(o.mouse),o.drag.end=o.canvasToTile(o.mouse),window.requestAnimationFrame((function(){o.appState.setOffset(r)}))}else o.drag.end=o.canvasToTile(o.mouse),o.appState.tools.brush.selected&&o.points.push(o.worldToTile(o.canvasToWorld(o.mouse),!1))},this.onWheel=function(e){if(void 0!==e.x&&void 0!==e.y&&document.elementFromPoint(e.x,e.y)===o.canvas){e.stopPropagation(),e.preventDefault(),o.dirty=new Date;var t=o.mouse,n=o.appState,a=n.scale,r=n.offset;t&&(r[0]-=e.deltaX*a,r[1]-=e.deltaY*a,window.requestAnimationFrame((function(){o.appState.setOffset(r)})))}},this.onKeyDown=function(e){if(o.dirty=new Date,"Shift"===e.key&&(o.specialKeys.shift=!0),"Control"===e.key&&(o.specialKeys.ctrl=!0),"Alt"===e.key&&(o.specialKeys.alt=!0),document.activeElement===document.body){var t=o.appState;"Backspace"!==e.key&&"Delete"!==e.key||t.handleDelete(),"z"===e.key&&o.specialKeys.ctrl&&t.undo(),"y"===e.key&&o.specialKeys.ctrl&&t.redo()," "===e.key&&(o.canvas.style.cursor="pointer",o.specialKeys.space=!0,e.preventDefault())}},this.onKeyUp=function(e){o.dirty=new Date,"Shift"===e.key&&(o.specialKeys.shift=!1),"Control"===e.key&&(o.specialKeys.ctrl=!1),"Alt"===e.key&&(o.specialKeys.alt=!1)," "===e.key&&(o.canvas.style.cursor="auto",o.specialKeys.space=!1)},this.canvasToWorld=function(e){var t=o.appState,n=t.offset,a=t.scale;return[e[0]/a-n[0],e[1]/a-n[1]]},this.worldToCanvas=function(e){var t=o.appState,n=t.offset,a=t.scale;return[(e[0]+n[0])*a,(e[1]+n[1])*a]},this.worldToTile=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var n=o.size/o.appState.gridSteps;return[Math.round(e[0]/n)/o.appState.gridSteps,Math.round(e[1]/n)/o.appState.gridSteps]}return[e[0]/o.size,e[1]/o.size]},this.canvasToTile=function(e){return o.worldToTile(o.canvasToWorld(e))},this.render=function(e){if((new Date).getTime()-o.dirty.getTime()<5e3){var t=performance.now(),n=o.ctx,a=o.appState,r=a.tools;o.polygonToolSelected&&!a.tools.polygon.selected&&(o.points=[]),o.polygonToolSelected=a.tools.polygon.selected,n.resetTransform(),o.bufferCtx.resetTransform(),o.clearScreen(),o.drawLevels(),n.save(),n.scale(a.scale,a.scale),n.translate(a.offset[0],a.offset[1]),n.scale(o.size,o.size),"edit"===o.mode&&(o.mouse&&o.drawMousePos(o.mouse),o.points.length>0&&r.polygon.selected?o.drawPolygon(o.points,"#2f557466","#2f5574"):o.points.length>0&&r.brush.selected?o.drawBrush(o.points,"#2f557466","#2f5574"):o.drag&&o.drawDrag()),n.restore();var i=performance.now()-t;o.fps=.1*i+.9*o.fps,a.debug&&o.renderFPS(e)}o.requestID=requestAnimationFrame(o.render)};var a=t.getContext("2d",{alpha:!0});if(null===a)throw new Error("canvas has null rendering context");this.canvas=t,this.ctx=a,this.requestID=requestAnimationFrame(this.render),this.bufferCanvas=document.createElement("canvas"),this.bufferCanvas.width=this.canvas.width,this.bufferCanvas.height=this.canvas.height;var r=this.bufferCanvas.getContext("2d",{alpha:!0});if(null===r)throw new Error("canvas has null rendering context");this.bufferCtx=r,this.mode=n}return Object(h.a)(e,[{key:"attachListeners",value:function(){this.canvas.addEventListener("touchstart",this.onMouseDown),this.canvas.addEventListener("mousedown",this.onMouseDown),this.canvas.addEventListener("mouseup",this.onMouseUp),this.canvas.addEventListener("touchend",this.onMouseUp),this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("touchmove",this.onMouseMove),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),window.addEventListener("wheel",this.onWheel,{passive:!1})}},{key:"detachListeners",value:function(){this.canvas.removeEventListener("mousedown",this.onMouseDown),this.canvas.removeEventListener("mouseup",this.onMouseUp),this.canvas.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.removeEventListener("wheel",this.onWheel)}},{key:"renderTextCenter",value:function(e,t){this.ctx.font=t;var n=this.ctx.measureText(e),o=n.actualBoundingBoxAscent+n.actualBoundingBoxDescent;this.ctx.fillText(e,-n.width/2,o)}},{key:"renderFPS",value:function(e){var t=this.fps.toFixed(0);this.ctx.save(),this.ctx.translate(this.canvas.width-48,12),this.ctx.fillStyle="#000",this.renderTextCenter(t,"18px Roboto Mono, monospace"),this.ctx.restore()}},{key:"clearScreen",value:function(){var e=this.canvas,t=this.ctx,n=this.bufferCanvas;"edit"===this.mode?(t.fillStyle="#D9D2BF",t.fillRect(0,0,e.width,e.height)):t.clearRect(0,0,e.width,e.height),n.width===e.width&&n.height===e.height||(n.width=e.width,n.height=e.height)}},{key:"drawGrid",value:function(){var e=this.canvas,t=this.ctx,n=t.getTransform().inverse(),o=n.transformPoint({x:0,y:0}),a=n.transformPoint({x:e.width,y:e.height});t.lineWidth=.01,t.strokeStyle="#000";for(var r=Math.floor(o.x);r<=a.x;r++)t.beginPath(),t.moveTo(r,o.y),t.lineTo(r,a.y),t.stroke();for(var i=Math.floor(o.y);i<=a.y;i++)t.beginPath(),t.moveTo(o.x,i),t.lineTo(a.x,i),t.stroke();if(1!==this.appState.gridSteps&&"edit"===this.mode){t.lineWidth=.005,t.strokeStyle="#666666";for(var s=Math.floor(o.x);s<=a.x;s+=1/this.appState.gridSteps)t.beginPath(),t.moveTo(s,o.y),t.lineTo(s,a.y),t.stroke();for(var l=Math.floor(o.y);l<=a.y;l+=1/this.appState.gridSteps)t.beginPath(),t.moveTo(o.x,l),t.lineTo(a.x,l),t.stroke()}}},{key:"drawMousePos",value:function(e){var t=this.ctx;t.save();var n=this.worldToTile(this.canvasToWorld(e),!0);if(t.fillStyle="#000",t.beginPath(),t.arc(n[0],n[1],.1,0,2*Math.PI),t.fill(),this.appState.debug){var o="0.5px Roboto, sans-serif";t.translate(n[0],n[1]-1),this.renderTextCenter("Mouse: ".concat(e[0].toFixed(0),",").concat(e[1].toFixed(0)),o),t.translate(0,-.5),this.renderTextCenter("Tile: ".concat(n[0].toFixed(0),",").concat(n[1].toFixed(0)),o)}t.restore()}},{key:"drawDrag",value:function(){var e=this.drag,t=this.appState;if(e){var n=e.start,o=e.end;if(b(n,o)>1&&t.tools.rect.selected)this.drawGeometry({type:"polygon",coordinates:[n,[n[0],o[1]],o,[o[0],n[1]]]},"#2f557466","#2f5574");else if(b(n,o)>1&&t.tools.stairs.selected)this.drawStairs([n,o],"#2f557466","#2f5574");else if(b(n,o)>1&&t.tools.decoration.selected)this.drawDecoration(t.tools.decoration.subtype,[n,o],"#2f557466","#2f5574");else if(b(n,o)>1&&t.tools.ellipse.selected){var a=j([n,o]);this.drawEllipse([a.sw,a.ne],"#2f557466","#2f5574")}else this.drawLine([n,o],.1,"#2f5574")}}},{key:"drawGeometry",value:function(e,t,n,o){"polygon"===e.type?this.drawPolygon(e.coordinates,t||o,n||o):"ellipse"===e.type?this.drawEllipse(e.coordinates,t||o,n||o):"line"===e.type?this.drawLine(e.coordinates,void 0!==o?.5:.1,n||o):"brush"===e.type?this.drawBrush(e.coordinates,t||o,n||o):"door"===e.type?this.drawDoor(e.subtype,e.coordinates,t||o,n||o):"stairs"===e.type?this.drawStairs(e.coordinates,o,n||o):"decoration"===e.type&&this.drawDecoration(e.subtype,e.coordinates,o,n||o)}},{key:"drawPolygon",value:function(e,t,n){var o=this.ctx;if(this.pathPoints(e,!0),t&&(o.fillStyle=t,o.fill()),n&&(o.strokeStyle=n,o.lineWidth=.1,o.stroke()),t&&we.includes(t)){this.drawPoints(e);var a=j(e);o.fillStyle="#000",o.save(),o.translate(a.sw[0]+a.w/2,a.ne[1]-1),this.renderTextCenter("".concat(5*a.w,"ft x ").concat(5*a.h,"ft"),"1px Roboto, sans-serif"),o.restore()}}},{key:"drawEllipse",value:function(e,t,n){var o=this.ctx;if(this.pathEllipse(e,!0),t&&(o.fillStyle=t,o.fill()),n&&(o.strokeStyle=n,o.lineWidth=.1,o.stroke()),t&&we.includes(t)){var a=j(e);this.drawPoints([a.sw,[a.sw[0],a.ne[1]],a.ne,[a.ne[0],a.sw[1]]]),o.fillStyle="#000",o.save(),o.translate(a.sw[0]+a.w/2,a.ne[1]-1),this.renderTextCenter("".concat(5*a.w,"ft x ").concat(5*a.h,"ft"),"1px Roboto, sans-serif"),o.restore()}}},{key:"drawLine",value:function(e,t,n){var o=this.ctx;this.pathPoints(e),n&&(o.strokeStyle=n,o.lineWidth=t,o.stroke())}},{key:"drawBrush",value:function(e,t,n){var o=this.ctx;this.pathPoints(e),t&&(o.strokeStyle=t,o.lineJoin="round",o.lineCap="round",o.lineWidth=.9,o.stroke()),this.ctx.globalCompositeOperation="destination-over",n&&(o.strokeStyle=n,o.lineJoin="round",o.lineCap="round",o.lineWidth=1.1,o.stroke()),this.ctx.globalCompositeOperation="source-over",t&&we.includes(t)&&this.drawPoints(e,.1)}},{key:"drawDoor",value:function(e,t,n,o){switch(e){case"normal":this.drawNormalDoor(t,n,o);break;case"secret":this.drawSecretDoor(t,n,o);break;default:throw new Error("unsupported door type ".concat(e))}}},{key:"drawNormalDoor",value:function(e,t,n){var o=this.ctx,a=Object(c.a)(e,2),r=a[0],i=a[1],s=w(.1,r,i),l=w(.9,r,i);n&&(o.strokeStyle=n,o.lineCap="butt",o.lineWidth=.1,o.beginPath(),o.moveTo(r[0],r[1]),o.lineTo(i[0],i[1]),o.stroke(),o.lineWidth=.3,o.beginPath(),o.moveTo(s[0],s[1]),o.lineTo(l[0],l[1]),o.stroke())}},{key:"drawSecretDoor",value:function(e,t,n){var o=this.ctx,a=Object(c.a)(e,2),r=a[0],i=a[1];if(n){var s=Math.max(Math.abs(r[0]-i[0]),Math.abs(r[1]-i[1]));o.font="".concat(s,"px Helvetica");var l=this.ctx.measureText("S"),p=l.actualBoundingBoxAscent+l.actualBoundingBoxDescent,d=(l.actualBoundingBoxLeft-l.actualBoundingBoxRight)/2,u=p/2;o.save(),o.fillStyle=n,o.fillText("S",r[0]+(i[0]-r[0])/2+d,r[1]+(i[1]-r[1])/2+u),o.restore()}}},{key:"drawStairs",value:function(e,t,n){if(n){var o=this.ctx,a=Object(c.a)(e,2),r=a[0],i=a[1],s=Math.abs(i[0]-r[0]),l=Math.abs(i[1]-r[1]),p=Math.sign(i[0]-r[0]),d=Math.sign(i[1]-r[1]),u=Math.max(s,l),h=Math.min(s,l);o.strokeStyle=n,o.lineWidth=.1,o.lineCap="butt";for(var m=0;m<u;m+=.5){var f=x(m/(u+.5),.1,h);o.beginPath(),s>l?(o.moveTo(r[0]+m*p,Math.min(r[1],i[1])+(h-f)/2),o.lineTo(r[0]+m*p,Math.min(r[1],i[1])+(h-f)/2+f)):(o.moveTo(Math.min(r[0],i[0])+(h-f)/2,r[1]+m*d),o.lineTo(Math.min(r[0],i[0])+(h-f)/2+f,r[1]+m*d)),o.stroke()}o.lineWidth=.05,o.beginPath(),s>l?(o.moveTo(r[0],r[1]),o.lineTo(i[0],r[1]),o.lineTo(i[0],i[1]),o.lineTo(r[0],i[1])):(o.moveTo(r[0],r[1]),o.lineTo(r[0],i[1]),o.lineTo(i[0],i[1]),o.lineTo(i[0],r[1])),o.stroke(),t&&(o.closePath(),o.fillStyle=t,o.fill()),n&&we.includes(n)&&this.drawPoints(e)}}},{key:"drawDecoration",value:function(e,t,n,o){switch(e){case"statue":this.drawStatue(t,n,o);break;case"column":this.drawColumn(t,n,o);break;case"stalacmite":this.drawStalacmite(t,n,o);break;default:throw new Error("unsupported decoration type ".concat(e))}}},{key:"drawStatue",value:function(e,t,n){if(n){var o=this.ctx,a=Object(c.a)(e,2),r=a[0],i=a[1],s=Math.max(Math.abs(i[0]-r[0]),Math.abs(i[1]-r[1]))/2,l=r[0]+s,p=r[1]+s;o.strokeStyle=n,o.lineWidth=.05,o.beginPath(),o.ellipse(l,p,s,s,0,0,2*Math.PI),o.stroke(),t&&(o.closePath(),o.fillStyle=t,o.fill());var d=.4*s;o.beginPath();for(var u=-.1*Math.PI,h=0;h<10;h++)0===h?o.moveTo(l+s*Math.cos(u),p+s*Math.sin(u)):o.lineTo(l+s*Math.cos(u),p+s*Math.sin(u)),u+=.2*Math.PI,o.lineTo(l+d*Math.cos(u),p+d*Math.sin(u)),u+=.2*Math.PI;o.closePath(),o.fillStyle=n,o.fill(),n&&we.includes(n)&&this.drawPoints(e)}}},{key:"drawColumn",value:function(e,t,n){if(n){var o=this.ctx,a=Object(c.a)(e,2),r=a[0],i=a[1],s=Math.max(Math.abs(i[0]-r[0]),Math.abs(i[1]-r[1]))/2,l=r[0]+s,p=r[1]+s;o.fillStyle=n,o.lineWidth=.05,o.beginPath(),o.ellipse(l,p,s,s,0,0,2*Math.PI),o.fill(),n&&we.includes(n)&&this.drawPoints(e)}}},{key:"drawStalacmite",value:function(e,t,n){if(n){var o=this.ctx,a=Object(c.a)(e,2),r=a[0],i=a[1],s=f()("(".concat(r[0],",").concat(r[1],"),(").concat(i[0],",").concat(i[1],")")),l=Math.max(Math.abs(i[0]-r[0]),Math.abs(i[1]-r[1]))/2,p=r[0]+l,d=r[1]+l;o.strokeStyle=n,o.lineWidth=.1,o.beginPath();for(var u=l*Math.max(.5,s()),h=-.1*Math.PI,m=0;m<20&&(0===m?o.moveTo(p+u*Math.cos(h),d+u*Math.sin(h)):o.lineTo(p+u*Math.cos(h),d+u*Math.sin(h)),!((h+=.2*s()*Math.PI)+.1*Math.PI>=2*Math.PI));m++)s()<.5?u+=.3*s():u-=.3*s(),u=Math.max(0,Math.min(l,u));o.closePath(),o.stroke(),t&&(o.fillStyle=t,o.fill()),n&&we.includes(n)&&this.drawPoints(e)}}},{key:"drawPoints",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25,n=this.ctx;n.fillStyle="#fff238",n.strokeStyle="black",n.lineWidth=.05;for(var o=0;o<e.length;o++)n.beginPath(),n.ellipse(e[o][0],e[o][1],t,t,0,0,2*Math.PI),n.fill(),n.stroke()}},{key:"pathPoints",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.ctx;n.beginPath(),n.moveTo(e[0][0],e[0][1]);for(var o=0;o<e.length;o++)n.lineTo(e[o][0],e[o][1]);t&&n.closePath()}},{key:"pathEllipse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.ctx,o=Object(c.a)(e,2),a=o[0],r=o[1];n.beginPath(),n.ellipse(a[0]+(r[0]-a[0])/2,a[1]+(r[1]-a[1])/2,(r[0]-a[0])/2,(a[1]-r[1])/2,0,0,2*Math.PI),t&&n.closePath()}},{key:"drawFeatures",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=["room","other","text"],a=["polygon","ellipse","line","brush","door","stairs","decoration"];o.forEach((function(o){a.forEach((function(a){e.features.forEach((function(e,r){e.properties.type===o&&e.geometries.forEach((function(e,o){if(e.type===a)if(n)t.drawGeometry(e,void 0,void 0,E(r,o));else{var i="#F1ECE0";"polygon"!==e.type||S(e.coordinates)||(i="#D9D2BF"),t.drawGeometry(e,i,"#000")}}))}))}))})),e.features.filter((function(e){return e.properties.name})).forEach((function(e,n){var o,a=e.geometries.find((function(e){return"polygon"===e.type})),r=e.geometries.find((function(e){return"ellipse"===e.type})),i=e.geometries.find((function(e){return"brush"===e.type}));if(a)o=M(a.coordinates);else if(r)o=[r.coordinates[0][0]+(r.coordinates[1][0]-r.coordinates[0][0])/2,r.coordinates[0][1]+(r.coordinates[1][1]-r.coordinates[0][1])/2];else{if(!i)return;o=i.coordinates[Math.round(i.coordinates.length/2)]}t.ctx.save(),t.ctx.translate(o[0],o[1]-.25),t.ctx.fillStyle="#000",t.renderTextCenter("".concat(n+1),"0.5px Helvetica"),t.ctx.restore()}))}},{key:"drawLevels",value:function(){var e,t,n=this,o=this.appState,a=this.canvas,r=a.width,i=a.height,s=this.ctx,l=this.appState.maps[this.appState.selection.mapIndex].levels[this.appState.selection.levelIndex];if(this.ctx=this.bufferCtx,"edit"===this.mode){if(this.ctx.resetTransform(),this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle="#fff",this.ctx.fillRect(0,0,r,i),this.ctx.save(),this.ctx.scale(o.scale,o.scale),this.ctx.translate(o.offset[0],o.offset[1]),this.ctx.scale(this.size,this.size),this.drawFeatures(l,!0),this.mouse){var p=this.ctx.getImageData(this.mouse[0],this.mouse[1],1,1).data,d=(e=p[0],t=p[1],p[2],[e,t]),u=Object(c.a)(d,2),h=u[0],m=u[1];h===1/0||h>=l.features.length||m>=l.features[h].geometries.length?this.hover=void 0:this.hover={featureIndex:h,geometryIndex:m}}this.ctx.restore()}if(this.ctx.resetTransform(),this.ctx.clearRect(0,0,r,i),this.ctx.save(),this.ctx.scale(o.scale,o.scale),this.ctx.translate(o.offset[0],o.offset[1]),this.ctx.scale(this.size,this.size),this.drawFeatures(l),o.tools.pointer.selected){if(void 0!==this.hover&&void 0!==this.hover.featureIndex){var f=l.features[this.hover.featureIndex];void 0!==this.hover.geometryIndex&&void 0!==f&&this.drawGeometry(f.geometries[this.hover.geometryIndex],"#668dad66","#668dad")}var v=this.appState.getSelectedFeature();if(v&&(v.feature.geometries.forEach((function(e){n.drawGeometry(e,e===v.geometry?"#2f557466":"#668dad66",e===v.geometry?"#2f5574":"#668dad66")})),this.drag&&b(this.drag.start,this.drag.end))){this.ctx.save();var y=[this.drag.end[0]-this.drag.start[0],this.drag.end[1]-this.drag.start[1]];this.ctx.translate(y[0],y[1]),v.feature.geometries.forEach((function(e){n.drawGeometry(e,"#2f557466","#2f5574")})),this.ctx.restore()}}if(this.ctx.globalCompositeOperation="source-over",o.tools.doors.selected&&this.mouse){var g=T(this.worldToTile(this.canvasToWorld(this.mouse),!1),l.features,this.specialKeys.shift);g&&this.drawDoor(o.tools.doors.subtype,[g.from,g.to],void 0,"#000")}"edit"===this.mode?this.ctx.globalCompositeOperation="source-over":this.ctx.globalCompositeOperation="source-atop",this.drawGrid(),this.ctx.restore(),s.drawImage(this.bufferCanvas,0,0),this.ctx=s}}]),e}();function Ee(e){var t=Object(o.useRef)(null),n=Object(o.useContext)(he),r=Object(o.useState)(),i=Object(c.a)(r,2),s=i[0],l=i[1];return Object(o.useEffect)((function(){if(null!==t.current){var o=t.current,a=new Oe(o,e.mode),r=function(){var e,t;o.width=(null===(e=o.parentElement)||void 0===e?void 0:e.offsetWidth)||o.width,o.height=(null===(t=o.parentElement)||void 0===t?void 0:t.offsetHeight)||o.height,a.dirty=new Date};return r(),a.attachListeners(),window.addEventListener("resize",r),a.appState=n,a.mode=e.mode,n.notifyChange=function(){a.dirty=new Date},l(a),function(){window.removeEventListener("resize",r),a.detachListeners()}}}),[t,n,e.mode]),a.a.createElement("div",{style:{flex:"1 1 auto"}},a.a.createElement("canvas",{ref:t,style:{flex:"1 1 auto"}}),a.a.createElement(xe,{renderer:s}))}var je=n(33),Se=n(34),ke=n.n(Se),Ie=n(104);function De(e){return a.a.createElement("div",{className:Ie.formattedText},a.a.createElement("h1",null,e.name),a.a.createElement("div",{dangerouslySetInnerHTML:{__html:Object(je.sanitize)(ke()(e.text||""))}}))}var Te=n(106);function Me(e){return a.a.createElement("div",{className:Te.editor},a.a.createElement("div",{style:{display:"flex",alignContent:"center"}},a.a.createElement("input",{className:ge.input,style:{flexGrow:1},value:e.name||"",onChange:function(t){e.onNameChange(t.target.value)}})),a.a.createElement("textarea",{value:e.description||"",onChange:function(t){e.onDescriptionChange(t.target.value)}}),a.a.createElement("div",{className:Te.actions},a.a.createElement("button",{className:ge.button,onClick:e.onSave},"Save"),a.a.createElement("button",{className:ve()(ge.button),onClick:e.onUndo},"Undo"),e.onDelete&&a.a.createElement("button",{className:ve()(ge.button,ge.danger),onClick:e.onDelete},"Delete")),a.a.createElement(De,{name:e.name,text:e.description}))}function Pe(){var e=Object(o.useContext)(he),t=e.getSelectedFeature(),n=Object(o.useState)(e.selection),r=Object(c.a)(n,2),i=r[0],s=r[1],l=Object(o.useState)(void 0),p=Object(c.a)(l,2),d=p[0],u=p[1],h=Object(o.useState)(void 0),m=Object(c.a)(h,2),f=m[0],v=m[1];e.selection.levelIndex===i.levelIndex&&e.selection.featureIndex===i.featureIndex||(s(e.selection),u(void 0),v(void 0));var y=d||"";void 0===d&&void 0!==(null===t||void 0===t?void 0:t.feature.properties.name)&&(y=null===t||void 0===t?void 0:t.feature.properties.name);var g=f||"";return void 0===f&&void 0!==(null===t||void 0===t?void 0:t.feature.properties.description)&&(g=null===t||void 0===t?void 0:t.feature.properties.description),a.a.createElement("div",null,a.a.createElement("h3",{style:{color:"white"}},"Area"),a.a.createElement(Me,{name:y,description:g,onNameChange:u,onDescriptionChange:v,onSave:function(){e.setFeatureDescription({name:void 0===d?null===t||void 0===t?void 0:t.feature.properties.name:d,description:void 0===f?null===t||void 0===t?void 0:t.feature.properties.description:f}),u(void 0),v(void 0)},onUndo:function(){t&&(t.feature.properties.name&&u(t.feature.properties.name),t.feature.properties.description&&v(t.feature.properties.description))},onDelete:function(){e.handleDelete()}}))}var _e=n(50),Ce=n(108);function Ne(){var e=Object(o.useContext)(he),t=e.maps[e.selection.mapIndex].levels[e.selection.levelIndex],n=Object(o.useState)(e.selection),r=Object(c.a)(n,2),i=r[0],s=r[1],l=Object(o.useState)(void 0),p=Object(c.a)(l,2),d=p[0],u=p[1],h=Object(o.useState)(void 0),m=Object(c.a)(h,2),f=m[0],y=m[1];e.selection.mapIndex!==i.mapIndex&&(s(e.selection),u(void 0),y(void 0));var g=t.features.map((function(e,t){return{index:t,feature:e}})).filter((function(e){return e.feature.properties.name})),b=function(t){return function(){e.setSelection(Object(v.a)(Object(v.a)({},e.selection),{},{featureIndex:t,geometryIndex:0}))}},x=d||"";void 0===d&&(x=t.name||"");var w=f||"";return void 0===f&&(w=t.description||""),a.a.createElement("div",null,a.a.createElement("h3",{style:{color:"white"}},"Level"),a.a.createElement(Me,{name:x,description:w,onNameChange:u,onDescriptionChange:y,onSave:function(){e.setLevelDescription({name:void 0===d?t.name:d,description:void 0===f?t.description:f}),u(void 0),y(void 0)},onUndo:function(){u(t.name),y(t.description)}}),a.a.createElement("div",{className:Ce.features},a.a.createElement(_e.a,{onDragEnd:function(t){t.destination&&e.setFeatureOrder(g[t.source.index].index,g[t.destination.index].index)}},a.a.createElement(_e.c,{droppableId:"droppable"},(function(t,n){return a.a.createElement("div",Object.assign({},t.droppableProps,{ref:t.innerRef,style:(n.isDraggingOver,{background:"#373737",padding:"4px",width:"250px"})}),g.map((function(t,n){return a.a.createElement(_e.b,{key:n,draggableId:n.toString(),index:n},(function(o,r){var i,s,l;return a.a.createElement("div",Object.assign({ref:o.innerRef},o.draggableProps,o.dragHandleProps,{onClick:b(t.index),style:(r.isDragging,s=(null===(i=e.getSelectedFeature())||void 0===i?void 0:i.feature)===t.feature,l=o.draggableProps.style||{},Object(v.a)({userSelect:"none",padding:"4px",margin:"0",background:"#373737",textDecoration:s?"underline":""},l))}),"".concat(n+1,". ").concat(t.feature.properties.name))}))})),t.placeholder)})))))}function Fe(){var e=Object(o.useContext)(he),t=e.maps[e.selection.mapIndex],n=Object(o.useState)(e.selection),r=Object(c.a)(n,2),i=r[0],s=r[1],l=Object(o.useState)(void 0),p=Object(c.a)(l,2),d=p[0],u=p[1],h=Object(o.useState)(void 0),m=Object(c.a)(h,2),f=m[0],v=m[1];e.selection.mapIndex!==i.mapIndex&&(s(e.selection),u(void 0),v(void 0));var y=d||"";void 0===d&&(y=t.name||"");var g=f||"";return void 0===f&&(g=t.description||""),a.a.createElement("div",null,a.a.createElement("h3",{style:{color:"white"}},"Map"),a.a.createElement(Me,{name:y,description:g,onNameChange:u,onDescriptionChange:v,onSave:function(){e.setMapDescription({name:void 0===d?t.name:d,description:void 0===f?t.description:f}),u(void 0),v(void 0)},onUndo:function(){u(t.name),v(t.description)}}))}var Le=n(111);function ze(){var e=Object(o.useContext)(he),t=e.getSelectedFeature(),n=Object(o.useRef)(null),r=function e(t){if(1===t.buttons){if(n.current){var o=n.current.dataset.drag;if(o){var a=parseInt(n.current.style.width.replace("px",""));n.current.style.width="".concat(a+(parseInt(o)-t.screenX),"px")}n.current.dataset.drag=t.screenX.toString()}}else document.removeEventListener("mousemove",e)};return a.a.createElement("div",{ref:n,className:ve()(Le.drawer,e.drawerOpen&&Le.open),style:{width:e.drawerOpen?"".concat(e.drawerWidth,"px"):0}},a.a.createElement("button",{className:ve()(Le.toggleButton,e.drawerOpen&&Le.open),onClick:function(){n.current&&(n.current.dataset.drag?n.current.dataset.drag="":e.setDrawerOpen(!e.drawerOpen))},onMouseDown:function(e){document.addEventListener("mousemove",r)},onMouseUp:function(t){if(document.removeEventListener("mousemove",r),n.current){var o=parseInt(n.current.style.width.replace("px",""));o>100&&(e.setDrawerWidth(o),e.setDrawerOpen(!0))}}},e.drawerOpen&&a.a.createElement(me.a,{icon:ye.c}),!e.drawerOpen&&a.a.createElement(me.a,{icon:ye.b})),a.a.createElement("div",{className:Le.editors},a.a.createElement(Fe,null),a.a.createElement(Ne,null),t&&a.a.createElement(Pe,null)))}var We=n(113);function Xe(){var e=Object(o.useContext)(he);return a.a.createElement("div",{className:We.levels},a.a.createElement("h4",null,"Levels"),e.maps[e.selection.mapIndex].levels.map((function(t,n){return a.a.createElement("div",{key:n,className:We.level},a.a.createElement("button",{className:ve()(We.link,e.selection.levelIndex===n&&We.selected),onClick:function(){return e.selectLevel(n)}},n),a.a.createElement("button",{onClick:function(){return e.removeLevel(n)}},a.a.createElement(me.a,{icon:ye.h})))})),a.a.createElement("button",{onClick:function(){return e.addLevel()}},a.a.createElement(me.a,{icon:ye.j})))}var He=n(115);function Ae(e){return a.a.createElement("div",{className:He.modal,style:{display:e.open?"block":"none"}},a.a.createElement("div",{className:He.modalContent},a.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},a.a.createElement("button",{onClick:e.toggle},a.a.createElement(me.a,{icon:ye.m}))),e.children))}var Ke=n(117);function Be(e){var t=Object(o.useContext)(he);return a.a.createElement("div",null,a.a.createElement("h2",null,"Maps"),a.a.createElement("div",null,t.maps.map((function(t,n){return a.a.createElement("div",{key:n},a.a.createElement("h4",{className:Ke.mapLink,onClick:function(){return e.onSelect(n)}},t.name))}))))}function Re(){var e=Object(o.useContext)(he),t=Object(d.f)(),n=Object(o.useState)(void 0),r=Object(c.a)(n,2),i=r[0],s=r[1],l=void 0===i?e.maps[e.selection.mapIndex].name:i,p=Object(o.useState)(!1),u=Object(c.a)(p,2),h=u[0],m=u[1],f=Object(o.useState)(e.selection),v=Object(c.a)(f,2),y=v[0],g=v[1];return e.selection.mapIndex===y.mapIndex&&e.selection.mapIndex===y.mapIndex||(g(e.selection),s(void 0)),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:Ke.menubar},a.a.createElement("span",{className:Ke.title},"RPG.ai"),a.a.createElement("input",{className:ge.input,value:l,onChange:function(e){s(e.target.value)}}),a.a.createElement("button",{className:ge.buttonSmall,onClick:function(){e.save(l||"")}},"Save"),e.maps.length>1&&a.a.createElement("button",{className:ge.buttonSmall,onClick:function(){m(!0)}},"Load"),a.a.createElement("button",{className:ge.buttonSmall,onClick:function(){e.newMap()}},"New"),a.a.createElement("button",{className:ge.buttonSmall,onClick:function(){e.undo()}},"Undo"),a.a.createElement("button",{className:ge.buttonSmall,onClick:function(){e.redo()}},"Redo"),a.a.createElement("button",{className:ge.buttonSmall,onClick:function(){t.push("/print")}},"Print"),a.a.createElement("button",{className:ge.buttonSmall,onClick:function(){e.toggleWelcome()}},"Help"),e.debug&&a.a.createElement("button",{className:ge.buttonSmall,onClick:function(){e.reset()}},"Clear"),a.a.createElement("div",{className:Ke.debugMenu},a.a.createElement("label",null,"Debug"),a.a.createElement("input",{type:"checkbox",checked:e.debug,onChange:function(t){return e.setDebug(t.target.checked)}}))),h&&a.a.createElement(Ae,{open:h,toggle:function(){return m(!h)}},a.a.createElement(Be,{onSelect:function(t){e.setSelection({mapIndex:t,levelIndex:0,featureIndex:void 0,geometryIndex:void 0}),m(!1)}})))}var Ue=n(120);function Ye(){var e=Object(o.useContext)(he);return a.a.createElement("div",{className:Ue.navigation},a.a.createElement("button",{onClick:function(){return e.setZoom(1,[0,0])}},a.a.createElement(me.a,{icon:ye.g})))}var qe=n(122);function Ge(){var e=Object(o.useContext)(he),t=e.maps[e.selection.mapIndex],n=[];return t.levels.forEach((function(e,t){n.push(Object(v.a)(Object(v.a)({},e),{},{features:e.features.filter((function(e){return e.properties.name}))}))})),a.a.createElement("div",{className:qe.print},a.a.createElement("div",{className:qe.page},a.a.createElement("h2",null,t.name),a.a.createElement("div",{dangerouslySetInnerHTML:{__html:Object(je.sanitize)(ke()(t.description||""))}}),a.a.createElement("div",{className:qe.canvasWrapper},a.a.createElement(Ee,{mode:"print"}))),a.a.createElement("div",{className:qe.pages},n.map((function(e,t){return a.a.createElement("div",{key:t},a.a.createElement("h2",null,e.name),a.a.createElement("div",{dangerouslySetInnerHTML:{__html:Object(je.sanitize)(ke()(e.description||""))}}),e.features.map((function(e,n){return a.a.createElement("div",{key:n},a.a.createElement("h3",null,"".concat(t+1,".").concat(n+1," ").concat(e.properties.name)),a.a.createElement("div",{dangerouslySetInnerHTML:{__html:Object(je.sanitize)(ke()(e.properties.description||""))}}))})))}))))}var Je={prefix:"fab",iconName:"statue",icon:[100,100,[],"none","M 50.000001,0.87620926 C 53.837858,11.917235 57.675715,22.958261 61.513572,33.999287 c 11.686603,0.238155 23.373206,0.47631 35.059809,0.714465 -9.314677,7.061883 -18.629353,14.123767 -27.94403,21.18565 3.38486,11.188214 6.76972,22.376428 10.15458,33.564642 C 69.189287,82.787502 59.594644,76.11096 50,69.434418 40.405356,76.110959 30.810711,82.787501 21.216067,89.464042 24.600928,78.275829 27.985788,67.087615 31.370649,55.899402 22.055973,48.837518 12.741296,41.775633 3.4266201,34.713749 15.113223,34.475595 26.799825,34.237441 38.486428,33.999287 42.324286,22.958261 46.162143,11.917235 50.000001,0.87620926 Z"]},Qe=n(124);function Ze(){return a.a.createElement("div",{className:Qe.welcomePage},a.a.createElement("h2",null,"Welcome to the RPG.ai Mapmaker"),a.a.createElement("h3",null,"Quick Start"),a.a.createElement("ul",null,a.a.createElement("li",null,"Use the scroll wheel or hold space to scroll around"),a.a.createElement("li",null,"Select the Wall tool (",a.a.createElement(me.a,{icon:ye.k}),") to build walls"),a.a.createElement("li",null,"Select the Rect tool (",a.a.createElement(me.a,{icon:ye.n}),") for rectangular areas"),a.a.createElement("li",null,"Place Decorations (",a.a.createElement(me.a,{icon:Je}),") and Doors (",a.a.createElement(me.a,{icon:ye.d}),") "),a.a.createElement("li",null,"Select and Annotate your areas (checkout the Drawer ",a.a.createElement(me.a,{icon:ye.b})," on the right)"),a.a.createElement("li",null,'Click "Print" and print your map as a PDF')),a.a.createElement("h3",null,"Support"),a.a.createElement("ul",null,a.a.createElement("li",null,"File bugs at ",a.a.createElement("a",{href:"https://github.com/etherealmachine/rpg-ai/issues"},"Github Issues")),a.a.createElement("li",null,"If you like the project, or want more features, support development on ",a.a.createElement("a",{href:"https://www.patreon.com/etherealmachine"},"Patreon"))),a.a.createElement("p",{className:Qe.footer},"Developed by ",a.a.createElement("a",{href:"https://github.com/etherealmachine"},"@etherealmachine"),", Copyright 2020"))}var Ve=n(140),$e=n(126);function et(e){var t=Object(o.useRef)(null),n=Object(o.useRef)(null),r=Object(o.useRef)(null),i=Object(o.useState)(!1),s=Object(c.a)(i,2),l=s[0],p=s[1],d=function(){p(!0)},u=function(){p(!1)};return Object(o.useEffect)((function(){t.current&&r.current&&Object(Ve.a)(t.current,r.current,{placement:"right",modifiers:[{name:"offset",options:{offset:[0,20]}}]}),n.current&&(n.current.addEventListener("mouseenter",d),n.current.addEventListener("mouseleave",u))}),[t,r]),a.a.createElement("div",{ref:t},a.a.createElement("span",{ref:r,style:l?{}:{visibility:"hidden"},className:$e.tooltip},e.tooltip),a.a.createElement("div",{ref:n},e.children))}var tt=n(128);function nt(e){return a.a.createElement("label",{className:tt.toggle},a.a.createElement("input",{type:"checkbox",checked:e.toggled,onChange:e.onToggle}),a.a.createElement("span",{className:tt.slider}))}var ot=n(66),at={pointer:{icon:ye.i,tooltip:"Select"},walls:{icon:ye.k,tooltip:"Walls"},stairs:{icon:{prefix:"fab",iconName:"stairs",icon:[100,100,[],"none","M 88.894187,13.349653 H 75.858354 67.310207 v 8.548146 13.036436 H 54.274372 45.726226 v 8.548149 13.035835 H 32.689789 24.141641 v 8.548147 13.035835 H 2.557659 v 8.548146 h 30.13213 V 78.1022 65.066366 H 54.274372 V 56.518219 43.482384 H 75.858354 V 34.934235 21.897799 h 13.035833 8.548154 v -8.548146 z"]},tooltip:"Stairs"},doors:{tooltip:"Doors",options:{normal:{icon:ye.d,tooltip:"Normal Door"},secret:{icon:ye.l,tooltip:"Secret Door"}}},decoration:{tooltip:"Decorations",options:{statue:{icon:Je,tooltip:"Statue"},column:{icon:{prefix:"fab",iconName:"column",icon:[100,100,[],"none","M 99.307838,50.000002 C 99.676865,71.680786 83.863735,92.30908 62.849037,97.645153 43.43672,103.02916 21.169043,95.169716 9.7285742,78.512925 -1.6384271,62.63998 -2.3896164,39.964144 8.336037,23.568937 18.693791,7.0444626 39.349174,-2.2666802 58.573467,1.4133904 77.242915,4.6178118 93.377617,19.344785 97.783979,37.839728 c 1.009833,3.969178 1.527479,8.064294 1.523859,12.160274 z"]},tooltip:"Column"},stalacmite:{icon:{prefix:"fab",iconName:"stalacmite",icon:[100,100,[],"none","m 74.415659,92.321351 c -4.943641,0.08102 -9.841762,-1.089484 -14.790343,-0.658213 -3.565886,-0.471723 -7.22558,0.729371 -9.905688,3.089052 -1.962324,1.335386 -5.447033,1.324308 -6.094083,1.821715 -3.85956,0.399841 -7.750871,0.28678 -11.573283,0.679078 -2.618647,-0.623551 -6.036085,-0.489443 -8.075905,-1.732656 1.155957,-3.724279 4.94719,-5.230686 7.705191,-7.514488 2.969895,-1.745463 3.119779,-6.066341 3.390628,-9.173885 0.977271,-3.506623 0.968227,-6.763139 0.834314,-10.383359 0.215923,-3.830242 -0.1664,-7.549928 0.655209,-11.170453 0.846053,-3.59887 2.294525,-6.963584 3.511139,-10.460921 0.866289,-3.295106 0.609567,-7.081046 1.683639,-10.061072 1.42479,-3.266581 3.711094,-6.049776 5.124971,-9.287309 1.837583,-3.091687 3.916701,-6.009869 3.773832,-9.893974 0.571828,-4.55039 1.017447,-9.2261117 1.445585,-13.7209267 3.030585,-2.95287215 6.303553,0.1796971 8.022745,2.5391129 3.780486,-0.6640017 2.841131,5.3726878 4.064949,7.7612308 0.861812,3.528943 1.440482,7.099871 1.327164,10.73674 -0.02487,3.466809 0.535472,6.773821 1.338634,10.143058 1.921669,3.216066 -0.39964,6.716109 0.466581,10.116214 -0.08226,4.045679 1.089512,8.062286 2.357768,11.873417 3.207109,1.44481 4.605866,4.867853 4.700711,8.604547 -0.214383,4.020444 0.705194,8.095625 -0.21518,12.020218 -0.141146,3.376494 0.09043,6.94965 1.137373,9.996727 1.650808,1.264756 0.198735,3.557255 -0.885951,4.676147 z"]},tooltip:"Stalacmite"}}},brush:{icon:ye.a,tooltip:"Paint"},rect:{icon:ye.n,tooltip:"Rectangle"},polygon:{icon:ye.e,tooltip:"Polygon"},ellipse:{icon:ot.a,tooltip:"Circle/Ellipse"}};function rt(){var e=Object(o.useContext)(he),t=function(t,n){return!!e.tools[t].hasOwnProperty("subtype")&&e.tools[t].subtype===n},n=function(t,n){return function(){e.setToolOption(t,n)}},r=function(t){var n=at[t];return(null===n||void 0===n?void 0:n.options)?n.options[e.tools[t].subtype].icon||ye.f:(null===n||void 0===n?void 0:n.icon)||ye.f};return a.a.createElement("div",{className:ge.toolbar,style:{position:"absolute",top:"50px",left:"24px"}},Object.entries(e.tools).map((function(o){var i,s,l=Object(c.a)(o,2),p=l[0],d=l[1];return a.a.createElement(et,{key:p,tooltip:null===(i=at[p])||void 0===i?void 0:i.tooltip},a.a.createElement(a.a.Fragment,null,a.a.createElement("button",{className:d.selected?ge.selected:"",disabled:d.disabled,onClick:(s=p,function(){e.setSelectedTool(s)})},a.a.createElement(me.a,{icon:r(p)})),d.selected&&at[p].options&&a.a.createElement("div",{className:ge.toolbar},Object.entries(at[p].options||{}).map((function(e){var o=Object(c.a)(e,2),r=o[0],i=o[1];return a.a.createElement(et,{key:r,tooltip:i.tooltip},a.a.createElement("button",{className:t(p,r)?ge.selected:"",onClick:n(p,r)},a.a.createElement(me.a,{icon:i.icon||ye.f})))})))))})),a.a.createElement(nt,{toggled:2===e.gridSteps,onToggle:function(){e.setGridSteps(1===e.gridSteps?2:1)}}))}var it=n(38);function st(e){return e&&"object"===typeof e&&!Array.isArray(e)}function lt(e){var t=void 0;if(e instanceof Array){t=[];e.forEach((function(e){t.push(e)}))}else if(e instanceof String)t=e;else if("object"==typeof e)for(var n in t={},e)t[n]=e[n];return t}function ct(e,t){var n=window.localStorage.getItem(e);null!==n&&function e(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];if(!o.length)return t;var r=o.shift();if(st(t)&&st(r))for(var i in r)st(r[i])?(t[i]||Object.assign(t,Object(it.a)({},i,{})),e(t[i],r[i])):(Object.isFrozen(t)&&(t=lt(t)),Object.assign(t,Object(it.a)({},i,r[i])));return e.apply(void 0,[t].concat(o))}(t,JSON.parse(n));var a=Object(o.useState)(t),r=Object(c.a)(a,2),i=r[0],s=r[1];return[i,function(t){window.localStorage.setItem(e,JSON.stringify(t)),s(t)}]}var pt=n(130);function dt(){var e=Object(o.useState)(0),t=Object(c.a)(e,2),n=t[0],r=t[1],i=ct("AppState",new ue),s=Object(c.a)(i,2),l=s[0],u=s[1];return l.setState=function(e){u(e),r(n+1)},window.app=l,document.title=l.maps[l.selection.mapIndex].name||"RPG.ai",a.a.createElement(p.a,null,a.a.createElement(d.c,null,a.a.createElement(d.a,{path:"/print"},a.a.createElement("div",{className:pt.app},a.a.createElement(he.Provider,{value:l},a.a.createElement(Ge,null)))),a.a.createElement(d.a,{path:"/"},a.a.createElement("div",{className:pt.app,style:{overflow:"hidden"}},a.a.createElement(he.Provider,{value:l},a.a.createElement(Re,null),a.a.createElement("div",{className:pt.canvasWrapper},a.a.createElement(Ae,{open:l.showWelcome,toggle:l.toggleWelcome.bind(l)},a.a.createElement(Ze,null)),a.a.createElement(Ee,{mode:"edit"}),a.a.createElement(ze,null),a.a.createElement(rt,null),a.a.createElement(Xe,null),a.a.createElement(Ye,null)))))))}s.a({dsn:"https://d42a7c4cafcb47f5b298dbf6e44b1834@o486991.ingest.sentry.io/5545134",integrations:[new l.a.BrowserTracing],tracesSampleRate:1}),i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(dt,null)),document.getElementById("root"))}]),[[74,1,2]]]);
//# sourceMappingURL=main.d20a030d.chunk.js.map